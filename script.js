require=function t(e,n,r){function a(o,s){if(!n[o]){if(!e[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[o]={exports:{}};e[o][0].call(l.exports,(function(t){return a(e[o][1][t]||t)}),l,l.exports,t,e,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({"tachikomas/AnonGift":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(n,t);var e=i(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,t)}return n}(t("./Common"));e.exports=c},{"./Common":"tachikomas/Common"}],"tachikomas/Ban":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(n,t);var e=i(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,t)}return n}(t("./Common"));e.exports=c},{"./Common":"tachikomas/Common"}],"tachikomas/ChartRoot":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("../../../helpers/signals").eventSignals,o=t("../../shared/chartFilter"),s=t("../../../singletons/twitchClient"),c=t("../../../helpers/utils"),u=t("../../../helpers/constants"),l=t("material-color-hash").default,_="undefined"!=typeof window?window._:void 0!==n?n._:null,h=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._enabled=!1,this._chartDomSelector=e.chartDomSelector,this._title=e.title,this._helpContent=e.helpContent,this._type=e.type||"doughnut",this.update=_.throttle((function(){n._update(),n._updateChartObject()}),e.updateThrottleTime||500),i.add(this._eventSignalsFunc.bind(this)),this.reset()}var e,n,h,f,p;return e=t,(n=[{key:"_eventSignalsFunc",value:function(t){switch(t.event){case"channel.input.update":this.reset();break;case"stream.load.ready":this.enable(),this.reset(),this._updateChartObject();break;case"stream.cleanup":this.disable();break;case"data.cache.updated":case"filter.change":this._enabled&&this.update()}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1}},{key:"_update",value:(f=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})),p=function(){var t=this,e=arguments;return new Promise((function(n,a){var i=f.apply(t,e);function o(t){r(i,n,a,o,s,"next",t)}function s(t){r(i,n,a,o,s,"throw",t)}o(void 0)}))},function(){return p.apply(this,arguments)})},{key:"reset",value:function(){}},{key:"_getParameters",value:function(){for(var t=o.getStartTime().unix(),e=o.getEndTime().unix(),n=o.getIntervalLevel(),r=c.getTimeBucket(t,n),a=c.getTimeBucket(e,n),i=Math.floor((a-r)/n)+1;n!=u.BUCKET_DAY&&i>=250;){var l=u.INTERVAL_BUCKETS.indexOf(n);n=u.INTERVAL_BUCKETS[l+1],i=Math.floor((a-r)/n)+1}return o.setIntervalLevel(n),{interval:n,startBucket:r=c.getTimeBucket(t,n),endBucket:a=c.getTimeBucket(e,n),channel:s.getChannel(),filter:o.getUserFilter(),length:i}}},{key:"_getBackgroundColor",value:function(){return this._labels.map((function(t){var e=l(t,"200").backgroundColor;return"".concat(e,"4D")}))}},{key:"_getBorderColor",value:function(){return this._labels.map((function(t){var e=l(t,"200").backgroundColor;return"".concat(e,"FF")}))}},{key:"_updateChartObject",value:function(){var t,e=this;if(this._chartObject)return this._chartObject.data.datasets[0].data=this._datasets,Object.isFrozen(this._chartObject.data.labels)||(this._chartObject.data.labels=this._labels,this._chartObject.data.datasets[0].backgroundColor=this._getBackgroundColor(),this._chartObject.data.datasets[0].borderColor=this._getBorderColor()),void this._chartObject.update();document.getElementById(this._chartDomSelector).innerHTML=templates["./hbs/stream/components/chart.hbs"](this),this._helpDom=new BSN.Popover(document.getElementById("".concat(this._chartDomSelector,"-help")),{title:this._title,content:this._helpContent,placement:"left"}),"horizontalBar"===this._type&&(this._type="bar",t="y"),this._chartObject=new Chart(document.getElementById("canvas-".concat(this._chartDomSelector)),{type:this._type,data:{labels:this._labels,datasets:[{data:this._datasets,backgroundColor:this._getBackgroundColor(),borderColor:this._getBorderColor(),borderWidth:1,indexAxis:t}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:this._title,fontSize:18},tooltip:{callbacks:{afterLabel:function(t){return e.afterLabel?e.afterLabel(t.label):void 0}}}}}})}}])&&a(e.prototype,n),h&&a(e,h),t}();e.exports=h}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/signals":"tachikomas/signals","../../../helpers/utils":"tachikomas/utils","../../../singletons/twitchClient":"tachikomas/twitchClient","../../shared/chartFilter":"tachikomas/chartFilter","material-color-hash":void 0}],"tachikomas/Chatters":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("../../shared/chartFilter"),i=templates["./hbs/stream/components/chatters-group.hbs"],o=templates["./hbs/stream/components/chatters-group-list.hbs"],s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._update(e,n),this.toPreviousPage=_.throttle(this._toPreviousPage.bind(this),200),this.toNextPage=_.throttle(this._toNextPage.bind(this),200),this.updateChattersList=_.throttle(this._updateChattersList.bind(this),2e3)}var e,n,s;return e=t,(n=[{key:"_update",value:function(t,e){this.allChatters=a.getUserFilter().filterUsers(e),this._validatePageNumber(),this._key=t,this._expandButton||(this._chatterContainerDom=document.getElementById("chatter-container").insertAdjacentHTML("beforeend",i(this._key)),this._expandButton=new BSN.Collapse(document.getElementById("".concat(this._key,"-expand")))),this.allChatters.length<=250?document.getElementById("".concat(this._key,"-paginator")).classList.add("d-none"):(document.getElementById("".concat(this._key,"-paginator")).classList.remove("d-none"),this._updatePaginationNumbers()),document.getElementById("".concat(this._key,"-count")).textContent=this.allChatters.length,this._updateChattersList()}},{key:"_validatePageNumber",value:function(){var t=Math.max(this._pageNumber||0,0);this._pageNumber=250*t>this.allChatters.length?0:t}},{key:"_updatePaginationNumbers",value:function(){this.allChatters.length>250&&(document.getElementById("".concat(this._key,"-pagination-numbers")).textContent="".concat(this.getLeftIndex()," ~ ").concat(this.getRightIndex()))}},{key:"_updateChattersList",value:function(){document.getElementById("".concat(this._key,"-list-chatters")).innerHTML=o(this._getPage())}},{key:"update",value:function(t){this._update(this._key,t)}},{key:"getLeftIndex",value:function(){return 250*this._pageNumber}},{key:"getRightIndex",value:function(){return Math.min(this.allChatters.length,this.getLeftIndex()+250)}},{key:"_getPage",value:function(){return this.allChatters.slice(this.getLeftIndex(),this.getRightIndex())}},{key:"_toNextPage",value:function(){250*(this._pageNumber+1)<this.allChatters.length&&(this._pageNumber++,this._updatePaginationNumbers(),this._updateChattersList())}},{key:"_toPreviousPage",value:function(){this._pageNumber-1>=0&&(this._pageNumber--,this._updatePaginationNumbers(),this._updateChattersList())}}])&&r(e.prototype,n),s&&r(e,s),t}();e.exports=s},{"../../shared/chartFilter":"tachikomas/chartFilter"}],"tachikomas/Chat":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(n,t);var e=i(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,t)}return n}(t("./Common"));e.exports=c},{"./Common":"tachikomas/Common"}],"tachikomas/Cheer":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(n,t);var e=i(n);function n(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(r=e.call(this,t)).bits=parseInt(t.bits||0),r}return n}(t("./Common"));e.exports=c},{"./Common":"tachikomas/Common"}],"tachikomas/Common":[function(t,e,n){"use strict";e.exports=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.userID=parseInt(e["user-id"]||e.userID),this.displayName=e["display-name"]||e.displayName,this.timestamp=parseInt(e["tmi-sent-ts"])||e.timestamp}},{}],"tachikomas/DataBucket":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("../../../helpers/constants"),i=t("./DataNode"),o=t("../../../helpers/utils"),s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e?(this[a.TYPE_CHAT]=e[a.TYPE_CHAT].getCopy(n),this[a.TYPE_RESUB]=e[a.TYPE_RESUB].getCopy(n),this[a.TYPE_CHEER]=e[a.TYPE_CHEER].getCopy(n),this[a.TYPE_SUB]=e[a.TYPE_SUB].getCopy(n),this[a.TYPE_BAN]=e[a.TYPE_BAN].getCopy(n),this[a.TYPE_ANONGIFT]=e[a.TYPE_ANONGIFT].getCopy(n),this[a.TYPE_SUBGIFT]=e[a.TYPE_SUBGIFT].getCopy(n),this[a.TYPE_SUBMYSTERY]=e[a.TYPE_SUBMYSTERY].getCopy(n)):(this[a.TYPE_CHAT]=new i,this[a.TYPE_RESUB]=new i,this[a.TYPE_CHEER]=new i,this[a.TYPE_SUB]=new i,this[a.TYPE_BAN]=new i,this[a.TYPE_ANONGIFT]=new i,this[a.TYPE_SUBGIFT]=new i,this[a.TYPE_SUBMYSTERY]=new i)}var e,n,s;return e=t,(n=[{key:"add",value:function(t){this[o.getMessageType(t)].add(t)}},{key:"getCopy",value:function(e){return new t(this,e)}},{key:"merge",value:function(t){var e=this;return Object.keys(t).forEach((function(n){e[n].merge(t[n])})),this}},{key:"split",value:function(t){var e=this;Object.keys(t).forEach((function(n){e[n]&&e[n].split(t[n])}))}}])&&r(e.prototype,n),s&&r(e,s),t}();e.exports=s},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/utils":"tachikomas/utils","./DataNode":"tachikomas/DataNode"}],"tachikomas/DataChannel":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("../../../helpers/constants"),i=t("../../../helpers/utils"),o=t("./DataBucket"),s=t("./DataNode"),c=t("./blanks"),u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._cachedInterval=void 0,this._cachedFilterString="",this._cache={},this._cacheTotalByHour={},this._data={},this._updated=new Set}var e,n,u;return e=t,(n=[{key:"add",value:function(t){var e=Math.floor(t.timestamp/1e3),n=i.getTimeBucket(e,a.BUCKET_MIN);this._updated.add(n),this._data[n]||(this._data[n]=new o),this._data[n].add(t)}},{key:"_getAt",value:function(t,e){var n=this._data[t];return n?n.getCopy(e):c.blankDataBucket}},{key:"_getAnInterval",value:function(t,e,n){for(var r=this._getAt(t,n),i=t+a.BUCKET_MIN;i<t+e;i+=a.BUCKET_MIN)r=r.merge(this._getAt(i,n));return Object.freeze(r)}},{key:"_validateCache",value:function(t,e){var n=this;this._cachedInterval===t&&this._cachedFilterString===e._searchString?this._updated.forEach((function(e){var r=i.getTimeBucket(e,t);delete n._cache[r],delete n._cacheTotalByHour[i.getTimeBucket(r,a.BUCKET_HOUR)]})):(this._cacheTotalByHour={},this._cache={}),this._updated.clear(),this._cachedFilterString=e._searchString,this._cachedInterval=t}},{key:"get",value:function(t,e,n){return this._validateCache(e,n),this._cache[t]||(this._cache[t]=this._getAnInterval(t,e,n)),this._cache[t]}},{key:"getTotal",value:function(t,e,n,r){this._validateCache(this._cachedInterval||a.BUCKET_MIN,r);for(var i,o=new s,u=t;u<=e;u+=a.BUCKET_MIN){if(u%a.BUCKET_HOUR==0){if(this._cacheTotalByHour[u]&&this._cacheTotalByHour[u][n]&&0!=this._cacheTotalByHour[u][n]._sum){o=o.merge(this._cacheTotalByHour[u][n]),u+=a.BUCKET_HOUR-a.BUCKET_MIN;continue}if(i){var l=u-a.BUCKET_HOUR;this._cacheTotalByHour[l]||(this._cacheTotalByHour[l]=c.blankDataBucket.getCopy()),this._cacheTotalByHour[l][n]=i}i=new s}var h=this._getAt(u,r)[n];o=o.merge(h),i&&(i=i.merge(h))}return o}}])&&r(e.prototype,n),u&&r(e,u),t}();e.exports=u},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/utils":"tachikomas/utils","./DataBucket":"tachikomas/DataBucket","./DataNode":"tachikomas/DataNode","./blanks":"tachikomas/blanks"}],"tachikomas/DataNode":[function(t,e,n){"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._sum=e||0,this._users=n||{}}var e,n,o;return e=t,(n=[{key:"add",value:function(t){var e=t.bits?t.bits/100:1;this._sum+=e,this._users[t.displayName]=(this._users[t.displayName]||0)+e}},{key:"getCopy",value:function(e){var n=this;if(!e)return new t(this._sum,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this._users));var i=0,o=Object.keys(this._users).reduce((function(t,r){return e.isApplicable(r)&&(i+=n._users[r],t[r]=n._users[r]),t}),{});return new t(i,o)}},{key:"merge",value:function(t){var e=this;return t&&(this._sum+=t._sum,Object.keys(t._users).forEach((function(n){e._users[n]=(e._users[n]||0)+t._users[n]}))),this}},{key:"split",value:function(t){var e=this;return this._sum-=t._sum,Object.keys(t._users).forEach((function(n){e._users[n]&&(e._users[n]-=t._users[n]),e._users[n]<=0&&delete e._users[n]})),this}}])&&i(e.prototype,n),o&&i(e,o),t}();e.exports=o},{}],"tachikomas/DateTime":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("../../../helpers/constants"),i=t("../../../helpers/signals").eventSignals,moment=t("../../../helpers/moment"),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.dom=document.getElementById(e),this.timeSelector=flatpickr(this.dom,{dateFormat:"Y-m-d H:i",enableTime:!0,allowInput:!0,clickOpens:!0,time_24hr:!0,minDate:"2020-01-01 00:00",defaultDate:moment().toDate(),onValueUpdate:_.debounce((function(){return i.dispatch({event:"date.change"},1e3)}))})}var e,n,o;return e=t,(n=[{key:"get",value:function(){return moment(this.timeSelector.selectedDates[0])}},{key:"set",value:function(t){this.timeSelector.setDate([t.format(a.MOMENT_DISPLAY_FORMAT)],!0)}},{key:"destroy",value:function(){this.timeSelector.destroy()}}])&&r(e.prototype,n),o&&r(e,o),t}();e.exports=o},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/moment":"tachikomas/moment","../../../helpers/signals":"tachikomas/signals"}],"tachikomas/MysterySubGift":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(n,t);var e=i(n);function n(t,r,a){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),delete(i=e.call(this,t,r,0)).months,delete i.totalMonths,i.numSubs=a||t.numbOfSubs,i}return n}(t("./Sub"));e.exports=c},{"./Sub":"tachikomas/Sub"}],"tachikomas/ReSub":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(n,t);var e=i(n);function n(t,r,a){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,t,r,a)}return n}(t("./Sub"));e.exports=c},{"./Sub":"tachikomas/Sub"}],"tachikomas/SubGift":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(n,t);var e=i(n);function n(t,r,a){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(i=e.call(this,t,a,r)).recipientDisplayName=t["msg-param-recipient-display-name"]||t.recipientDisplayName,i.recipientID=t["msg-param-recipient-id"]||t.recipientID,i}return n}(t("./Sub"));e.exports=c},{"./Sub":"tachikomas/Sub"}],"tachikomas/Sub":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("./Common"),u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(n,t);var e=i(n);function n(t,r,a){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(i=e.call(this,t)).months=a||t.months,i.totalMonths=t["msg-param-cumulative-months"]||t.totalMonths,i.subType=r?function(t){if(t)return t.prime?"prime":t.planName}(r):t.subType,i.subRank=r?function(t){if(t)return t.plan}(r):t.subRank,i}return n}(c);e.exports=u},{"./Common":"tachikomas/Common"}],"tachikomas/User":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("../../helpers/constants").CSS_UNKNOWN,i=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._id=e,this._userName=n,this.userNameCSSClass=a,r&&(this._follows=new Set(Object.keys(r).map((function(t){return parseInt(t)}))))}var e,n,i;return e=t,(n=[{key:"getID",value:function(){return this._id}},{key:"getUserName",value:function(){return this._userName}},{key:"setID",value:function(t){this._id=t}},{key:"addFollows",value:function(t){var e=this;t&&(this._follows||(this._follows=new Set),(t.data||[]).forEach((function(t){return e._follows.add(parseInt(t.to_id))})))}},{key:"isFollowing",value:function(t){if(this._follows)return this._follows.has(t)}}])&&r(e.prototype,n),i&&r(e,i),t}();e.exports=i},{"../../helpers/constants":"tachikomas/constants"}],"tachikomas/api":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function s(t){r(o,a,i,s,c,"next",t)}function c(t){r(o,a,i,s,c,"throw",t)}s(void 0)}))}}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("../env"),moment=t("../helpers/moment"),s=t("http-status-codes").StatusCodes,c=t("../helpers/constants"),u=t("../helpers/signals").eventSignals,l="undefined"!=typeof window?window.pako:void 0!==n?n.pako:null,h={headers:{"Client-ID":o.CLIENT_ID,Accept:"application/vnd.twitchtv.v5+json"}},f=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,r,f,p,d;return e=t,(n=[{key:"reset",value:function(){this._waitForTimeOut&&clearTimeout(this._waitForTimeOut),this._waitForTimeOut=null,this.waitForReset=null}},{key:"_makeAPIQuery",value:(d=a(regeneratorRuntime.mark((function t(e,n){var r,a,i,o,f,p=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.waitForReset){t.next=4;break}return t.next=3,this.waitForReset;case 3:this.waitForReset=null;case 4:return t.next=6,fetch(e,n||h);case 6:if(r=t.sent,a=parseInt(r.headers.get(c.RATELIMIT_REMAINING)||10),i=moment().unix(),o=parseInt(r.headers.get(c.RATELIMIT_RESET)||i+c.MAX_AWAIT_DURATION_SEC),0!==a&&r.status!==s.TOO_MANY_REQUESTS){t.next=14;break}throw console.warn("too many requests! ".concat(o," ").concat(r.headers)),this.waitForReset||(f=Math.min(o-i,c.MAX_AWAIT_DURATION_SEC),o=i+f,this.waitForReset=new Promise((function(t){p._waitForTimeOut=setTimeout((function(){t(),u.dispatch({event:"api.unthrottled"})}),1e3*f)}))),{status:r.status,msg:"too many requests",resetAt:o};case 14:if(r.ok){t.next=17;break}throw console.warn("query failed!"),{status:r.status,msg:"query failed",resetAt:o};case 17:if(!(r.headers.get("Content-Type").indexOf("gzip")>-1)){t.next=26;break}return t.t0=JSON,t.t1=l,t.next=22,r.arrayBuffer();case 22:return t.t2=t.sent,t.t3={to:"string"},t.t4=t.t1.ungzip.call(t.t1,t.t2,t.t3),t.abrupt("return",t.t0.parse.call(t.t0,t.t4));case 26:return t.next=28,r.json();case 28:return t.abrupt("return",t.sent);case 29:case"end":return t.stop()}}),t,this)}))),function(t,e){return d.apply(this,arguments)})},{key:"queryTwitchApi",value:(p=a(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="".concat(o.TWITCH_ENDPOINT,"/").concat(e),t.abrupt("return",this._makeAPIQuery(r,n));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return p.apply(this,arguments)})},{key:"queryTmiApi",value:(f=a(regeneratorRuntime.mark((function t(e){var n,r,a,i,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(o.TMI_ENDPOINT,"/").concat(e),r=n.indexOf("127.0.0.1")>-1,a=r?n:"https://api.allorigins.win/get?url=".concat(encodeURIComponent(n)),t.next=5,fetch(a);case 5:return i=t.sent,t.next=8,i.json();case 8:return s=t.sent,t.abrupt("return",r?s:JSON.parse(s.contents));case 10:case"end":return t.stop()}}),t)}))),function(t){return f.apply(this,arguments)})}])&&i(e.prototype,n),r&&i(e,r),t}());e.exports=f}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../env":"tachikomas/env","../helpers/constants":"tachikomas/constants","../helpers/moment":"tachikomas/moment","../helpers/signals":"tachikomas/signals","http-status-codes":void 0}],"tachikomas/auth":[function(t,e,n){"use strict";function r(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function s(t){r(o,a,i,s,c,"next",t)}function c(t){r(o,a,i,s,c,"throw",t)}s(void 0)}))}}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("../env"),s=t("../helpers/signals").eventSignals,c="scope=user:read:email+bits:read+moderation:read+channel:read:subscriptions+analytics:read:games",u=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);try{this._authToken=JSON.parse(localStorage.getItem("auth"))}catch(t){this._authToken=void 0,console.warn("failed to parse localstorage cache",t)}}var e,n,r,u,l;return e=t,(n=[{key:"_setAuthToken",value:function(t){t&&(this._authToken=t,localStorage.setItem("auth",JSON.stringify(this._authToken)))}},{key:"_authWithSecret",value:(l=a(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o.CLIENT_SECRET){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,fetch("".concat(o.TWITCH_ENDPOINT,"/oauth2/token?client_id=").concat(o.CLIENT_ID,"&client_secret=").concat(o.CLIENT_SECRET,"&grant_type=client_credentials&").concat(c),{method:"POST"});case 4:return e=t.sent,t.next=7,e.json();case 7:n=t.sent,this._setAuthToken(n.access_token);case 9:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"authenticate",value:(u=a(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isAuthenticated()){t.next=2;break}return t.abrupt("return");case 2:if(!e){t.next=6;break}this._setAuthToken(e.get("access_token")),t.next=12;break;case 6:if(!o.CLIENT_SECRET){t.next=11;break}return t.next=9,this._authWithSecret();case 9:t.next=12;break;case 11:return t.abrupt("return","".concat(o.TWITCH_ENDPOINT,"/oauth2/authorize?client_id=").concat(o.CLIENT_ID,"&redirect_uri=").concat(o.REDIRECT_URL,"&response_type=token&").concat(c));case 12:if(!this.isAuthenticated()){t.next=28;break}return s.dispatch({event:"draw.nav.auth"}),t.prev=14,t.next=17,fetch("".concat(o.TWITCH_ENDPOINT,"/helix/users"),this.getAuthObj());case 17:return n=t.sent,t.next=20,n.json();case 20:(r=t.sent)&&(this._user=r.data[0]),t.next=27;break;case 24:t.prev=24,t.t0=t.catch(14),console.warn("failed to fetch logged in user info: ".concat(t.t0));case 27:this.isBroadcaster()&&s.dispatch({event:"channel.changed",channel:this.getLogin()});case 28:case"end":return t.stop()}}),t,this,[[14,24]])}))),function(t){return u.apply(this,arguments)})},{key:"isAuthenticated",value:function(){return Boolean(this._authToken)}},{key:"isBroadcaster",value:function(){return Boolean(this._user&&this._user.broadcaster_type&&""!==this._user.broadcaster_type)}},{key:"getLogin",value:function(){return this._user&&this._user.login}},{key:"getID",value:function(){return this._user&&this._user.id}},{key:"logout",value:function(){this._authToken=void 0,this._user=void 0,localStorage.removeItem("auth"),s.dispatch({event:"draw.nav.auth"})}},{key:"getAuthObj",value:function(){if(this.isAuthenticated())return{headers:{"Client-ID":o.CLIENT_ID,Accept:"application/vnd.twitchtv.v5+json",Authorization:"Bearer ".concat(this._authToken)}}}}])&&i(e.prototype,n),r&&i(e,r),t}());e.exports=u},{"../env":"tachikomas/env","../helpers/signals":"tachikomas/signals"}],"tachikomas/blanks":[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}var o=t("../../../helpers/constants"),s=t("./DataNode"),c=t("./DataBucket"),u=new(function(){function t(){r(this,t),this._sum=0,this._users={},Object.freeze(this)}return i(t,[{key:"merge",value:function(t){var e=this.getCopy();return e.merge(t),e}},{key:"getCopy",value:function(){return new s(0,{})}},{key:"split",value:function(){return this.getCopy()}}]),t}()),l=new(function(){function t(){r(this,t),this[o.TYPE_CHAT]=u,this[o.TYPE_RESUB]=u,this[o.TYPE_CHEER]=u,this[o.TYPE_SUB]=u,this[o.TYPE_BAN]=u,this[o.TYPE_ANONGIFT]=u,this[o.TYPE_SUBGIFT]=u,this[o.TYPE_SUBMYSTERY]=u,Object.freeze(this)}return i(t,[{key:"merge",value:function(t){var e=this.getCopy();return e.merge(t),e}},{key:"getCopy",value:function(){var t=new c;return t[o.TYPE_CHAT]=new s,t[o.TYPE_RESUB]=new s,t[o.TYPE_CHEER]=new s,t[o.TYPE_SUB]=new s,t[o.TYPE_BAN]=new s,t[o.TYPE_ANONGIFT]=new s,t[o.TYPE_SUBGIFT]=new s,t[o.TYPE_SUBMYSTERY]=new s,t}},{key:"split",value:function(){return this.getCopy()}}]),t}());e.exports.blankDataNode=u,e.exports.blankDataBucket=l},{"../../../helpers/constants":"tachikomas/constants","./DataBucket":"tachikomas/DataBucket","./DataNode":"tachikomas/DataNode"}],"tachikomas/channelFollowsFetcher":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _="undefined"!=typeof window?window._:void 0!==n?n._:null,i=t("../../simpletons/auth"),o=t("../../simpletons/api"),s=t("../../helpers/signals").eventSignals,c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._paginations={},this.fetch=_.throttle(this._fetch,5e3)}var e,n,c,u,l;return e=t,(n=[{key:"_fetch",value:(u=regeneratorRuntime.mark((function t(e){var n,r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&"done"!==this._paginations[e]){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,i.getAuthObj();case 4:n=t.sent,t.prev=5;case 6:return r="helix/users/follows?first=100&to_id=".concat(e),t.next=9,o.queryTwitchApi(this._paginations[e]?"".concat(r,"&after=").concat(this._paginations[e]):r,n);case 9:if(a=t.sent,s.dispatch({event:"fetch.channel.follows.resp",data:a,channelID:e}),a.pagination&&a.pagination.cursor){t.next=14;break}return this._paginations[e]="done",t.abrupt("return");case 14:this._paginations[e]=a.pagination.cursor;case 15:t.next=6;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(5),console.warn("failed to fetch channel follows",t.t0);case 22:case"end":return t.stop()}}),t,this,[[5,19]])})),l=function(){var t=this,e=arguments;return new Promise((function(n,a){var i=u.apply(t,e);function o(t){r(i,n,a,o,s,"next",t)}function s(t){r(i,n,a,o,s,"throw",t)}o(void 0)}))},function(t){return l.apply(this,arguments)})}])&&a(e.prototype,n),c&&a(e,c),t}();e.exports=new c}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../helpers/signals":"tachikomas/signals","../../simpletons/api":"tachikomas/api","../../simpletons/auth":"tachikomas/auth"}],"tachikomas/chartFilter":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("../../../helpers/constants"),i=t("../../../helpers/signals").eventSignals,moment=t("../../../helpers/moment"),o=t("../../../helpers/utils"),s=t("./userFilter"),c=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,c;return e=t,(n=[{key:"reset",value:function(){this._start=moment().set("second",0).set("millisecond",0),this._end=moment().set("second",0).set("millisecond",0),this._searchValue=void 0,this._intervalLevel=a.BUCKET_MIN}},{key:"update",value:function(t){var e={};t.start&&(t.start=o.muteSeconds(t.start),this._start&&t.start.unix()===this._start.unix()||(this._start=t.start,e.start=this._start)),t.end&&(t.end=o.muteSeconds(t.end),this._end&&t.end.unix()===this._end.unix()||(this._end=t.end,e.end=this._end)),"searchValue"in t&&(s.isSameSearchString(t.searchValue)||(s.changeSearchString(t.searchValue),e.filter=s)),t.intervalLevel&&t.intervalLevel!==this._intervalLevel&&(this._intervalLevel=t.intervalLevel,e.intervalLevel=this._intervalLevel),Object.keys(e).length>0&&i.dispatch({event:"filter.change",changed:e})}},{key:"getStartTime",value:function(){return this._start}},{key:"getEndTime",value:function(){return this._end}},{key:"getUserFilter",value:function(){return s}},{key:"getIntervalLevel",value:function(){return this._intervalLevel}},{key:"setIntervalLevel",value:function(t){this._intervalLevel=t}}])&&r(e.prototype,n),c&&r(e,c),t}());e.exports=c},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/moment":"tachikomas/moment","../../../helpers/signals":"tachikomas/signals","../../../helpers/utils":"tachikomas/utils","./userFilter":"tachikomas/userFilter"}],"tachikomas/chatsByUsersVC":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var a=h(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=t("./ChartRoot"),p=t("../../../helpers/constants"),d=t("../../../simpletons/dataCache"),m=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(f,t);var e,n,r,i,l,h=u(f);function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),h.call(this,{chartDomSelector:"pie-chats-by-users",title:"Chat Counts by User Name",helpContent:"<p>Chats grouped by user name</p>"})}return e=f,(n=[{key:"reset",value:function(){this._labels=[],this._datasets=[]}},{key:"_update",value:(i=regeneratorRuntime.mark((function t(){var e,n,r,i,o,s,c,u,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getParameters();case 2:for(e=t.sent,n=e.channel,r=e.filter,i=e.startBucket,o=e.endBucket,s=d.getTotal(n,i,o,p.TYPE_CHAT,r),c=Object.entries(s._users).sort((function(t,e){var n=a(t,2)[1];return a(e,2)[1]-n})),u=Math.min(c.length,10),l=0;l<u;l++)this._labels[l]=c[l][0],this._datasets[l]=c[l][1];this._labels.length=u,this._datasets.length=u;case 13:case"end":return t.stop()}}),t,this)})),l=function(){var t=this,e=arguments;return new Promise((function(n,r){var a=i.apply(t,e);function s(t){o(a,n,r,s,c,"next",t)}function c(t){o(a,n,r,s,c,"throw",t)}s(void 0)}))},function(){return l.apply(this,arguments)})}])&&s(e.prototype,n),r&&s(e,r),f}(f));e.exports=m},{"../../../helpers/constants":"tachikomas/constants","../../../simpletons/dataCache":"tachikomas/dataCache","./ChartRoot":"tachikomas/ChartRoot"}],"tachikomas/chattersTableVC":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _="undefined"!=typeof window?window._:void 0!==n?n._:null,s=t("../shared/chartFilter"),c=t("../../singletons/users"),u=t("./components/Chatters"),l=["broadcaster","vips","moderators","staff","admins","global_mods","viewers"],h=templates["./hbs/stream/chatters.hbs"],f=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadChattersTable=_.debounce(this._loadChattersTable.bind(this)),this.onChattersSearchKeyUp=_.debounce((function(){s.update({searchValue:document.getElementById("chatters-search").value})}),1e3),t("../../helpers/signals").domSignals.add(this._domSignalsEvent.bind(this))}var n,i,f;return n=e,(i=[{key:"_domSignalsEvent",value:function(t){switch(t.type){case"click":if(t.id.endsWith("-page-right")){var e=t.id.replace("-page-right","");this._chatters[e].toNextPage()}else if(t.id.endsWith("-page-left")){var n=t.id.replace("-page-left","");this._chatters[n].toPreviousPage()}break;case"keyup":"chatters-search"===t.id&&this.onChattersSearchKeyUp()}}},{key:"_loadChattersTable",value:function(){this._chatters=this._chatters||{};var t,e=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}(Object.entries(c.getViewers())||{});try{for(e.s();!(t=e.n()).done;){var n=r(t.value,2),i=n[0],o=n[1];this._chatters[i]?this._chatters[i].update(o):this._chatters[i]=new u(i,o)}}catch(t){e.e(t)}finally{e.f()}}},{key:"initialize",value:function(){this.destroy(),document.getElementById("chatters-table").innerHTML=h(l),this.chattersAutocomplete=new Awesomplete(document.getElementById("chatters-search"),{minChars:1,maxItems:10,autoFirst:!0,list:[":following",":notfollowing"]}),this._helpDom=new BSN.Popover(document.getElementById("chatters-help"),{title:"Chatters View",content:"Displays current chatters in the channel refreshed at every minute.</br>\n            </br>\n            Chatters search can search via chatters name or any of the following flags.</br>\n            <ul>\n                <li><code>:following</code></li>\n                <li><code>:notfollowing</code></li>\n            </ul>",placement:"left"})}},{key:"updateChattersList",value:function(){for(var t in this._chatters)this._chatters[t].updateChattersList()}},{key:"destroy",value:function(){this.bsnChattersSearch&&(this.bsnChattersSearch.dispose(),this.bsnChattersSearch=void 0)}}])&&o(n.prototype,i),f&&o(n,f),e}();e.exports=new f}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../helpers/signals":"tachikomas/signals","../../singletons/users":"tachikomas/users","../shared/chartFilter":"tachikomas/chartFilter","./components/Chatters":"tachikomas/Chatters"}],"tachikomas/constants":[function(t,e,n){"use strict";e.exports=Object.freeze({MY_CONSTANT:"some value",ANOTHER_CONSTANT:"another value",TYPE_CHAT:0,TYPE_RESUB:1,TYPE_CHEER:2,TYPE_SUB:3,TYPE_BAN:4,TYPE_ANONGIFT:5,TYPE_SUBGIFT:6,TYPE_SUBMYSTERY:7,NUM_TYPES:8,CHART_LABEL:["chat","re-subscription","cheer","subscription","ban","anonymous gift","subscription gift","subscription mystery"],CHART_BACKGROUND_COLOR:["rgb(255, 255, 0, 0.3)","rgb(153, 255, 51, 0.3)","rgb(51, 255, 255, 0.3)","rgb(0, 128, 225, 0.3)","rgb(255, 51, 153, 0.3)","rgb(102, 0, 204, 0.3)","rgb(255, 128, 0, 0.3)","rgb(128, 128, 128, 0.3)"],CHART_BORDER_COLOR:["rgb(255, 255, 0, 1.0)","rgb(153, 255, 51, 1.0)","rgb(51, 255, 255, 1.0)","rgb(0, 128, 225, 1.0)","rgb(255, 51, 153, 1.0)","rgb(102, 0, 204, 1.0)","rgb(255, 128, 0, 1.0)","rgb(128, 128, 128, 1.0)"],KEY_AGG:"agg",KEY_UNIQUE_USERS:"unique_users",KEY_RAWS:"raws",KEY_USERS:"users",KEY_CURRENT:"_current",KEY_STREAMLEVEL:"streamLevel",TIMEFORMAT_DISPLAY:"YYYY/MM/DD HH:mm",KEY_CHATTERS:"chatters",KEY_CHATTERS_UPDATED_AT:"chatters_updated_at",NUM_CHATTERS_DISPLAY:250,KEY_BROADCASTER:"broadcaster",KEY_VIPS:"vips",KEY_MODERATORS:"moderators",KEY_STAFF:"staff",KEY_ADMIN:"admins",KEY_GLOBAL_MODS:"global_mods",KEY_VIEWERS:"viewers",PIE_NUM_USERS_TO_SHOW:10,BUCKET_MIN:60,BUCKET_FIVE:300,BUCKET_HOUR:3600,BUCKET_DAY:86400,INTERVAL_BUCKETS:[60,300,3600,86400],INTERVAL_BUCKETS_STRING:["1 minute","5 minutes","1 hour","1 day"],BUCKET_LAST:86400,SUGGESTED_DATA_COUNT:150,TABS_OPTIONS:["stream"],AUTH_NO_AUTH:-1,AUTH_EXPIRED:0,AUTH_VALID:1,HELP_EMAIL:"help@sonso.io",FAILED_USER_GRACE_PERIOD:3600,USERS_SYNC_VALID_DURATION:604800,RATELIMIT_REMAINING:"Ratelimit-Remaining",RATELIMIT_RESET:"Ratelimit-Reset",MAX_AWAIT_DURATION_SEC:15,TIMESTAMP_SEC_ATTR:"timestamp_sec",MAX_PARALLEL_USER_FOLLOWS_FETCH_LIMIT:10,MOMENT_DISPLAY_FORMAT:"YYYY-MM-DD HH:mm",CSS_UNKNOWN:"text-muted",CSS_FOLLOWING:"stream-following",CSS_NOT_FOLLOWING:"stream-not-following",MAX_VIEWERS_COUNTS_FOR_PROCESS:1e3,DEFAULT_CHANNEL:"xqcow",DEFAULT_CHANNE_ID:71092938})},{}],"tachikomas/dataCache":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("./models/DataChannel"),i=t("./models/DataNode"),o=t("../../helpers/signals").eventSignals,s=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,s;return e=t,(n=[{key:"reset",value:function(){this._data={}}},{key:"_isValidRaw",value:function(t){return t.displayName?!!t.timestamp||(console.warn("missing timestamp",t),!1):(console.warn("missing displayname",t),!1)}},{key:"_ensureChannelExists",value:function(t){this._data[t]||(this._data[t]=new a)}},{key:"add",value:function(t,e){this._isValidRaw(e)&&(this._ensureChannelExists(t),this._data[t].add(e),o.dispatch({event:"data.cache.updated"}))}},{key:"get",value:function(t,e,n,r){return this._ensureChannelExists(t),this._data[t].get(e,n,r)}},{key:"getTotal",value:function(t,e,n,r,a){return this._ensureChannelExists(t),this._data[t].getTotal(e,n,r,a)}},{key:"getNewDataNode",value:function(){return new i}}])&&r(e.prototype,n),s&&r(e,s),t}());e.exports=s},{"../../helpers/signals":"tachikomas/signals","./models/DataChannel":"tachikomas/DataChannel","./models/DataNode":"tachikomas/DataNode"}],"tachikomas/dateTimeRangeVC":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("../../helpers/utils"),i=t("./components/DateTime"),o=t("../shared/chartFilter"),s=new(function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultStart=a.getNow(),this.isLive=!0,window.addEventListener("focus",this._onWindowFocus.bind(this)),t("../../helpers/signals").domSignals.add(this._domSignalsFunc.bind(this))}var n,s,c;return n=e,(s=[{key:"_domSignalsFunc",value:function(t){"click"===t.type&&"time-reset"===t.id&&this._timeReset()}},{key:"_isValid",value:function(){return Boolean(this.start&&this.end)}},{key:"_setIsLive",value:function(){var t=this.end.get().unix()-a.getNow().add(-1,"minutes").unix();this.isLive=t>=0&&t<=60}},{key:"_timeReset",value:function(){this.start.set(this.defaultStart),this.end.set(a.getNow())}},{key:"_onWindowFocus",value:function(){this.isLive&&this._isValid()&&this._timeReset()}},{key:"setDate",value:function(){if(this._isValid()){var t=this.start.get(),e=this.end.get();if(e.unix()<t.unix())return this.start.set(e),void this.end.set(t);this._setIsLive(),o.update({start:t,end:e})}}},{key:"minProgressed",value:function(){this.isLive&&this._isValid()&&this.end.set(a.getNow())}},{key:"initialize",value:function(){this.destroy(),document.getElementById("time-selectors").innerHTML=templates["./hbs/stream/date-time-range.hbs"](),this.start=new i("time-start"),this.end=new i("time-end"),new BSN.Popover(document.getElementById("time-help"),{title:"Date range",content:"Data display time window.",delay:500,placement:"bottom"}),new BSN.Popover(document.getElementById("time-reset-help"),{title:"Reset time",content:"Reset time window to page load time to now",delay:500,placement:"bottom"})}},{key:"destroy",value:function(){this.start&&(this.start.destroy(),this.start=void 0),this.end&&(this.end.destroy(),this.end=void 0)}}])&&r(n.prototype,s),c&&r(n,c),e}());e.exports=s},{"../../helpers/signals":"tachikomas/signals","../../helpers/utils":"tachikomas/utils","../shared/chartFilter":"tachikomas/chartFilter","./components/DateTime":"tachikomas/DateTime"}],"tachikomas/env":[function(t,e,n){"use strict";e.exports={ENVIRONMENT:"prod",HOST_ENDPOINT:"https://jung-kim.github.io/tadashi",TWITCH_ENDPOINT:"https://api.twitch.tv",TMI_ENDPOINT:"https://tmi.twitch.tv",REDIRECT_URL:"https://jung-kim.github.io/tadashi/index.html",SERVICE:"tachikomas",CLIENT_ID:"nrmkyj3jbq4eukbuunluz5yygi9t7v",GIT_HASH:"9235e63",TAG:"9235e63"}},{}],"tachikomas/events":[function(t,e,n){"use strict";e.exports={AnonGift:t("./AnonGift"),Ban:t("./Ban"),Cheer:t("./Cheer"),Chat:t("./Chat"),MysterySubGift:t("./MysterySubGift"),ReSub:t("./ReSub"),SubGift:t("./SubGift"),Sub:t("./Sub")}},{"./AnonGift":"tachikomas/AnonGift","./Ban":"tachikomas/Ban","./Chat":"tachikomas/Chat","./Cheer":"tachikomas/Cheer","./MysterySubGift":"tachikomas/MysterySubGift","./ReSub":"tachikomas/ReSub","./Sub":"tachikomas/Sub","./SubGift":"tachikomas/SubGift"}],"tachikomas/followedStreamersVC":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=l(t);if(e){var a=l(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=t("../../shared/chartFilter"),f=t("./ChartRoot"),p=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(u,t);var e,n,r,i=c(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,{type:"horizontalBar",title:"Top followed streamers by viewers",chartDomSelector:"pie-followed-streamers",helpContent:"<p>Top followed streamers from viewers<br>\nTop 10 streamers followed by viewers.  </br>\nIncludes some viewers who may not be watching anymore.\n</p>",updateThrottleTime:5e3})}return e=u,(n=[{key:"_eventSignalsFunc",value:function(t){switch(t.event){case"channel.input.update":this.reset();break;case"stream.load.ready":this.enable(),this.reset(),this._updateChartObject();break;case"stream.cleanup":this.disable();break;case"fetch.user.follows.resp":this._enabled&&(this._pushToProcess(t.data),this.update())}}},{key:"reset",value:function(){this._map={},this._labels=[],this._datasets=[]}},{key:"_pushToProcess",value:function(t){var e=this;t.data.forEach((function(t){e._map[t.to_name]=(e._map[t.to_name]||0)+1}))}},{key:"_update",value:function(){this._labels=[],this._datasets=[];for(var t=h.getUserFilter(),e=0,n=Object.entries(this._map);e<n.length;e++){var r=a(n[e],2),i=r[0],o=r[1];if(!t.isValid()||t.isApplicable(i)){var s=(this._datasets.length>=10?10:this._datasets.length)-1;if(!(this._datasets.length>=10&&o<this._datasets[s])){for(var c=0;c<this._datasets.length&&!(o>this._datasets[c]);c++);this._datasets.splice(c,0,o),this._labels.splice(c,0,i)}}}this._datasets.length=Math.min(this._datasets.length,10),this._labels.length=Math.min(this._datasets.length,10)}}])&&o(e.prototype,n),r&&o(e,r),u}(f));e.exports=p},{"../../shared/chartFilter":"tachikomas/chartFilter","./ChartRoot":"tachikomas/ChartRoot"}],"tachikomas/main":[function(t,e,n){"use strict";function r(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function s(t){r(o,a,i,s,c,"next",t)}function c(t){r(o,a,i,s,c,"throw",t)}s(void 0)}))}}var i=t("./helpers/signals").eventSignals,o=t("./helpers/signals").domSignals,s=t("./helpers/utils"),c=t("./helpers/constants"),moment=t("./helpers/moment"),u=t("./singletons/twitchClient"),l=t("./simpletons/auth"),h=t("./singletons/users"),f=t("./events/shared/chartFilter"),p=function t(e){return e.id?e.id:e.parentElement?t(e.parentElement):"undefined"};window.env=t("./env.js"),window.onload=a(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.location.hash&&(e=new URLSearchParams(window.location.hash.substr(1)),l.authenticate(e)),t.next=3,u.initializeClient();case 3:document.getElementById("nav-auth").innerHTML=templates["./hbs/components/nav-auth.hbs"](l),i.dispatch({event:"stream.load"});case 5:case"end":return t.stop()}}),t)}))),window.authenticate=a(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.authenticate();case 2:(e=t.sent)&&(window.location=e);case 4:case"end":return t.stop()}}),t)}))),window.authLogout=function(){l.logout()},window.minIntervalEvent=setInterval((function(){i.dispatch({event:"main.minute",channel:u.getChannel(),filter:f.getUserFilter()});var t=s.getNow().add(1,"minute").valueOf()-moment.now();window.minTopTimeoutEvent=setTimeout((function(){i.dispatch({event:"main.minute.top"})}),t+5)}),6e4),window.domEvent=function(t,e){o.dispatch({id:e||p(t.target),type:t.type,event:t})},Handlebars.registerHelper("userFollowsCSS",(function(t){var e=h.getUserByName(t);if(!e)return c.CSS_UNKNOWN;switch(e.isFollowing(u.getChannelID())){case!0:return c.CSS_FOLLOWING;case!1:return c.CSS_NOT_FOLLOWING;default:return c.CSS_UNKNOWN}})),i.add((function(t){if(t.alert&&t.alert.body)return document.getElementById("alerts").insertAdjacentHTML("afterbegin",templates["./hbs/shared/alerts.hbs"](t.alert)),void new BSN.Alert(document.querySelector(".alert"))}))},{"./env.js":"tachikomas/env","./events/shared/chartFilter":"tachikomas/chartFilter","./helpers/constants":"tachikomas/constants","./helpers/moment":"tachikomas/moment","./helpers/signals":"tachikomas/signals","./helpers/utils":"tachikomas/utils","./simpletons/auth":"tachikomas/auth","./singletons/twitchClient":"tachikomas/twitchClient","./singletons/users":"tachikomas/users"}],"tachikomas/moment":[function(t,e,n){"use strict";var r;try{r=moment}catch(e){r=t("moment-timezone")}e.exports=r},{"moment-timezone":void 0}],"tachikomas/navOptionVC":[function(t,e,n){"use strict";function r(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function s(t){r(o,a,i,s,c,"next",t)}function c(t){r(o,a,i,s,c,"throw",t)}s(void 0)}))}}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("../../helpers/signals").eventSignals,s=t("../../singletons/twitchClient"),c=t("../../singletons/twitchAPI"),u=t("../../helpers/constants"),l=t("../shared/chartFilter"),h=function(){function e(){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.channelInputAutoComplete=void 0,this.toDsipose=[],this.fetchList=_.debounce(this._fetchList.bind(this),500,{leading:!1}),this.streamSelect=_.debounce(this._streamSelect.bind(this),500,{leading:!1}),this.populateStreamInfo=_.debounce(this._populateStreamInfo.bind(this),500,{leading:!1}),this.syncChannelInput=_.debounce((function(){n.channelInputAutoComplete.input.value=s.getChannel()}),250,{leading:!1}),t("../../helpers/signals").domSignals.add(this._domSignalsFunc.bind(this))}var n,r,h,f,p,d;return n=e,(r=[{key:"_domSignalsFunc",value:function(t){if("click"===t.type&&t.id.endsWith("-interval"))this._intervalClickEvent(t.event);else if("channel-input"===t.id)switch(t.type){case"keyup":this._onChannelInputKeyUp(t.event);break;case"click":this._refreshList();break;case"focusout":case"channel.input.update":this.syncChannelInput()}else if("channel-refresh"===t.id)switch(t.type){case"click":s.changeToRandomFeaturedStream()}else if("channel-save"===t.id)switch(t.type){case"click":s.saveChannel()}}},{key:"_onChannelInputKeyUp",value:function(t){if(13===t.keyCode||t.awesompleteSelect)return this.lastSearchedChannel=this.channelInputAutoComplete.input.value,void this.streamSelect();this._refreshList()}},{key:"_refreshList",value:function(){var t=this.channelInputAutoComplete.input.value;this.lastSearchedChannel!==t?(this.lastSearchedChannel=t,this.fetchList()):this.channelInputAutoComplete.open()}},{key:"_fetchList",value:(d=a(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.getChannelSearch(this.lastSearchedChannel);case 2:e=t.sent,this.channelInputAutoComplete.list=(e.data||[]).map((function(t){return t.display_name}));case 4:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"_streamSelect",value:(p=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.changeChannel(this.lastSearchedChannel);case 3:this.populateStreamInfo(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),o.dispatch({alert:{type:"warning",body:"Requested ".concat(this.lastSearchedChannel," is not a valid channel.")}});case 9:this.channelInputAutoComplete.close();case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return p.apply(this,arguments)})},{key:"_populateStreamInfo",value:(f=a(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.getChannel(),this.channelInputAutoComplete.input.value=this.lastSearchedChannel||e,document.getElementById("embeded-twitch-channel").innerText=e,t.prev=3,t.next=6,c.getChannelInfo(e);case 6:this.streamInfo=t.sent,this.streamInfo&&this.streamInfo.data&&this.streamInfo.data.length>0?document.getElementById("embeded-twitch-desc").innerHTML="".concat(this.streamInfo.data[0].title):document.getElementById("embeded-twitch-desc").innerHTML="(inactive...)",t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),document.getElementById("embeded-twitch-desc").innerHTML="".concat(e,"'s stream");case 13:case"end":return t.stop()}}),t,this,[[3,10]])}))),function(){return f.apply(this,arguments)})},{key:"_intervalClickEvent",value:function(t){var e=t.srcElement.innerHTML;switch(e){case"1 minute":l.update({intervalLevel:u.BUCKET_MIN});break;case"5 minutes":l.update({intervalLevel:u.BUCKET_FIVE});break;case"1 hour":l.update({intervalLevel:u.BUCKET_HOUR});break;case"1 day":l.update({intervalLevel:u.BUCKET_DAY})}document.getElementById("interval-selector-btn").innerText=e}},{key:"initialize",value:function(){this.destroy(),document.getElementById("nav-options").innerHTML=templates["./hbs/stream/nav-options.hbs"](),this.toDsipose.push(new BSN.Dropdown(document.getElementById("interval-selector"))),this.toDsipose.push(new BSN.Popover(document.getElementById("interval-selector-help"),{title:"Timeseries interval level",content:"Select timeseries interval level.",delay:500,placement:"bottom"})),this.toDsipose.push(new BSN.Popover(document.getElementById("channel-refresh-help"),{title:"Randomize channel",content:"Randomize channel based on featured streams API call.",delay:500,placement:"bottom"})),this.toDsipose.push(new BSN.Popover(document.getElementById("channel-save-help"),{title:"Save channel",content:"Cache channel to be used on next page time page loads.",delay:500,placement:"bottom"})),this.channelInputAutoComplete=new Awesomplete(document.getElementById("channel-input"),{minChars:4,maxItems:10,autoFirst:!0}),this.channelInputAutoComplete.input.addEventListener("awesomplete-selectcomplete",this._onChannelInputKeyUp.bind(this))}},{key:"destroy",value:function(){this.channelInputAutoComplete&&(this.channelInputAutoComplete.destroy(),this.channelInputAutoComplete=void 0),this.toDsipose.forEach((function(t){return t.dispose()})),this.toDsipose.length=0}}])&&i(n.prototype,r),h&&i(n,h),e}();e.exports=new h},{"../../helpers/constants":"tachikomas/constants","../../helpers/signals":"tachikomas/signals","../../singletons/twitchAPI":"tachikomas/twitchAPI","../../singletons/twitchClient":"tachikomas/twitchClient","../shared/chartFilter":"tachikomas/chartFilter"}],"tachikomas/proceedsByTypesVC":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=u(t);if(e){var a=u(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=t("./ChartRoot"),h=t("../../../helpers/constants"),f=t("../../../simpletons/dataCache"),p=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(p,t);var e,n,r,c,u,l=s(p);function p(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(t=l.call(this,{type:"bar",chartDomSelector:"pie-proceeds",title:"Overall Proceeds",helpContent:"<p>Proceeds by type<br>\n<ul>\n<li>100 Cheers count</li>\n<li>Subscription count</li>\n<li>Re-Subscription count</li>\n<li>Subscription Gifts count</li>\n<li>Mystery Subscription count</li>\n</ul>\n</p>"}))._labels=Object.freeze(["100 Cheer","Subs","Resubs","Sub Gifts","Sub Mystery"]),t._messageTypes=Object.freeze([h.TYPE_CHEER,h.TYPE_SUB,h.TYPE_RESUB,h.TYPE_SUBGIFT,h.TYPE_SUBMYSTERY]),t._backgroundColor=Object.freeze(t._messageTypes.map((function(t){return h.CHART_BACKGROUND_COLOR[t]}))),t._borderColor=Object.freeze(t._messageTypes.map((function(t){return h.CHART_BACKGROUND_COLOR[t]}))),t}return e=p,(n=[{key:"reset",value:function(){this._datasets=[0,0,0,0,0]}},{key:"_update",value:(c=regeneratorRuntime.mark((function t(){var e,n,r,a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getParameters();case 2:e=t.sent,n=e.channel,r=e.filter,a=e.startBucket,i=e.endBucket,this._datasets[0]=f.getTotal(n,a,i,h.TYPE_CHEER,r)._sum,this._datasets[1]=f.getTotal(n,a,i,h.TYPE_SUB,r)._sum,this._datasets[2]=f.getTotal(n,a,i,h.TYPE_RESUB,r)._sum,this._datasets[3]=f.getTotal(n,a,i,h.TYPE_SUBGIFT,r)._sum,this._datasets[4]=f.getTotal(n,a,i,h.TYPE_SUBMYSTERY,r)._sum;case 12:case"end":return t.stop()}}),t,this)})),u=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=c.apply(t,e);function o(t){a(i,n,r,o,s,"next",t)}function s(t){a(i,n,r,o,s,"throw",t)}o(void 0)}))},function(){return u.apply(this,arguments)})},{key:"_getBackgroundColor",value:function(){return this._backgroundColor}},{key:"_getBorderColor",value:function(){return this._borderColor}}])&&i(e.prototype,n),r&&i(e,r),p}(l));e.exports=p},{"../../../helpers/constants":"tachikomas/constants","../../../simpletons/dataCache":"tachikomas/dataCache","./ChartRoot":"tachikomas/ChartRoot"}],"tachikomas/proceedsByUsersVC":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var a=h(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=t("./ChartRoot"),p=t("../../../helpers/constants"),d=t("../../../simpletons/dataCache"),m=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(f,t);var e,n,r,i,l,h=u(f);function f(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(t=h.call(this,{chartDomSelector:"pie-proceeds-by-users",title:"Proceeds by User Name",helpContent:"<p>Proceeds by users<br>\n<ul>\n<li>100 Cheers</li>\n<li>Subscription count</li>\n<li>Re-Subscription count</li>\n<li>Subscription Gifts count</li>\n<li>Mystery Subscription count</li>\n</ul>\n</p>"}))._proceedsTypesToProcess=Object.freeze([p.TYPE_CHEER,p.TYPE_SUB,p.TYPE_RESUB,p.TYPE_SUBGIFT,p.TYPE_SUBMYSTERY]),t}return e=f,(n=[{key:"reset",value:function(){this._labels=[],this._datasets=[],this._sumByType=[],this._displayLimit=10}},{key:"_update",value:(i=regeneratorRuntime.mark((function t(){var e,n,r,i,o,s,c,u,l,h,f,p=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getParameters();case 2:for(e=t.sent,n=e.channel,r=e.filter,i=e.startBucket,o=e.endBucket,s={},c=this._proceedsTypesToProcess.reduce((function(t,e){var a=d.getTotal(n,i,o,e,r);return s[e]=a,t.merge(a)}),d.getNewDataNode()),u=Object.entries(c._users).sort((function(t,e){var n=a(t,2)[1];return a(e,2)[1]-n})),l=Math.min(u.length,this._displayLimit),h=function(t){var e=u[t][0];p._labels[t]=e,p._datasets[t]=u[t][1],p._sumByType[t]=p._proceedsTypesToProcess.reduce((function(t,n){var r=s[n]._users[e];return r&&(t[n]=r),t}),{})},f=0;f<l;f++)h(f);this._labels.length=l,this._datasets.length=l,this._sumByType.length=l;case 16:case"end":return t.stop()}}),t,this)})),l=function(){var t=this,e=arguments;return new Promise((function(n,r){var a=i.apply(t,e);function s(t){o(a,n,r,s,c,"next",t)}function c(t){o(a,n,r,s,c,"throw",t)}s(void 0)}))},function(){return l.apply(this,arguments)})},{key:"afterLabel",value:function(t){var e=this._labels.indexOf(t),n=this._sumByType[e];return Object.keys(n||{}).map((function(t){var e=n[t];return"  ".concat(p.CHART_LABEL[t],": ").concat(t==p.TYPE_CHEER?100*e:e)}))}}])&&s(e.prototype,n),r&&s(e,r),f}(f));e.exports=m},{"../../../helpers/constants":"tachikomas/constants","../../../simpletons/dataCache":"tachikomas/dataCache","./ChartRoot":"tachikomas/ChartRoot"}],"tachikomas/signals":[function(t,e,n){"use strict";var r=t("micro-signals").Signal;e.exports={eventSignals:new r,domSignals:new r}},{"micro-signals":void 0}],"tachikomas/stream":[function(t,e,n){"use strict";var r=t("../../helpers/signals").eventSignals,a=t("./chattersTableVC"),i=t("./twitchEmbededVC"),o=t("./navOptionVC"),s=t("./dateTimeRangeVC"),c=t("../shared/chartFilter"),u=function(t){switch(t.event){case"stream.load":document.getElementById("main").innerHTML=templates["./hbs/stream/index.hbs"](),a.initialize(),o.populateStreamInfo(),o.initialize(),i.initialize(),s.initialize(),r.dispatch({event:"stream.load.ready"});break;case"chatters.data.update.data":a.loadChattersTable();break;case"filter.change":t.changed&&t.changed.filter&&a.loadChattersTable(),t.changed&&t.changed.channel&&o.populateStreamInfo();break;case"filter.interval.change":document.getElementById("interval-selector-btn").innerText=t.label,c.update({intervalLevel:t.intervalLevel});break;case"main.minute":o.populateStreamInfo();break;case"date.change":s.setDate();break;case"main.minute.top":s.minProgressed();break;case"channel.input.update":o.populateStreamInfo();break;case"stream.cleanup":o.destroy(),s.destroy(),a.destroy();break;case"chatters.data.update.partial":a.updateChattersList()}};r.add(u),e.exports=u},{"../../helpers/signals":"tachikomas/signals","../shared/chartFilter":"tachikomas/chartFilter","./chattersTableVC":"tachikomas/chattersTableVC","./dateTimeRangeVC":"tachikomas/dateTimeRangeVC","./navOptionVC":"tachikomas/navOptionVC","./twitchEmbededVC":"tachikomas/twitchEmbededVC"}],"tachikomas/timeseriesVC":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=u(t);if(e){var a=u(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=t("../../shared/chartFilter"),moment=t("../../../helpers/moment"),h=t("../../../helpers/constants"),f=t("./ChartRoot"),p=t("../../../simpletons/dataCache"),d=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(d,t);var e,n,r,c,u,f=s(d);function d(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),f.call(this,{chartDomSelector:"canvas-timeseries"})}return e=d,(n=[{key:"reset",value:function(){this._chartLabels=[],this._chartDatasets=[],this._chartObject&&this._chartObject.destroy(),this._chartObject=void 0;for(var t=0;t<h.NUM_TYPES;t++)this._chartDatasets.push({label:h.CHART_LABEL[t],backgroundColor:h.CHART_BACKGROUND_COLOR[t],borderColor:h.CHART_BORDER_COLOR[t],borderWidth:1,data:[],users:[]})}},{key:"_update",value:(c=regeneratorRuntime.mark((function t(){var e,n,r,a,i,o,s,c,u,l,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getParameters();case 2:for(e=t.sent,n=e.interval,r=e.startBucket,a=e.channel,i=e.filter,o=e.length,s=0;s<o;s++)for(c=r+s*n,this._chartLabels[s]=moment.unix(c),u=p.get(a,c,n,i),l=0;l<h.NUM_TYPES;l++)this._chartDatasets[l].data[s]=u[l]._sum,this._chartDatasets[l].users[s]=u[l]._users;for(f=0;f<h.NUM_TYPES;f++)this._chartDatasets[f].data.length=o,this._chartDatasets[f].users.length=o;this._chartLabels.length=o;case 11:case"end":return t.stop()}}),t,this)})),u=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=c.apply(t,e);function o(t){a(i,n,r,o,s,"next",t)}function s(t){a(i,n,r,o,s,"throw",t)}o(void 0)}))},function(){return u.apply(this,arguments)})},{key:"_toolTipAfterLabel",value:function(t){if(t){var e=this._chartDatasets[t.datasetIndex];if(0!==t.yLabel&&l.getUserFilter().isValid()&&e.users&&e.users[t.dataIndex]){var n=e.users[t.dataIndex];return Object.keys(n).reduce((function(t,e){return t.push("  ".concat(e,": ").concat(n[e])),t}),[])}}}},{key:"_toolTipLabel",value:function(t){return"".concat(t.dataset.label,": ").concat(t.dataset.data[t.dataIndex])}},{key:"_toolTipTitle",value:function(t){var e=(t&&t[0]||{}).dataIndex;if(e>=0)return this._chartLabels[e].format(h.TIMEFORMAT_DISPLAY)}},{key:"_toolTipFilter",value:function(t){return t&&"0"!=t.formattedValue}},{key:"_scaleTicksFontStyle",value:function(t){switch(l.getIntervalLevel()){case h.BUCKET_DAY:return 1===t.tick.value.days()?"bold":void 0;case h.BUCKET_HOUR:return 0===t.tick.value.hours()?"bold":void 0;case h.BUCKET_FIVE:return 0===t.tick.value.minutes()?"bold":void 0;case h.BUCKET_MIN:return t.tick.value.minutes()%5==0?"bold":void 0;default:return}}},{key:"_scaleTicksCallback",value:function(t){var e=this._chartLabels[t];if(0===e.hours()&&0===e.minutes())return e.format("M/D");switch(l.getIntervalLevel()){case h.BUCKET_DAY:return e.format("M/D");default:return e.format("HH:mm")}}},{key:"_updateChartObject",value:function(){this._chartObject?(this._chartObject.data.labels=this._chartLabels,this._chartObject.data.datasets=this._chartDatasets,this._chartObject.update()):this._chartObject=new Chart(document.getElementById(this._chartDomSelector),{type:"bar",data:{labels:this._chartLabels,label:"# of Events",datasets:this._chartDatasets},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{display:!0,stacked:!0,ticks:{fontColor:"#7d7d7d",fontSize:14,fontStyle:this._scaleTicksFontStyle.bind(this),callback:this._scaleTicksCallback.bind(this)},gridLines:{display:!0,color:"#7d7d7d"}},y:{stacked:!0,gridLines:{display:!0,color:"#7d7d7d"},ticks:{fontColor:"#7d7d7d",fontSize:14,stepSize:5}}},plugins:{title:{display:!1},legend:{labels:{display:!0,color:"#7d7d7d"}},tooltip:{intersect:!1,mode:"index",filter:this._toolTipFilter.bind(this),callbacks:{title:this._toolTipTitle.bind(this),label:this._toolTipLabel.bind(this),afterLabel:this._toolTipAfterLabel.bind(this)}}}}})}}])&&i(e.prototype,n),r&&i(e,r),d}(f));e.exports=d},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/moment":"tachikomas/moment","../../../simpletons/dataCache":"tachikomas/dataCache","../../shared/chartFilter":"tachikomas/chartFilter","./ChartRoot":"tachikomas/ChartRoot"}],"tachikomas/twitchAPI":[function(t,e,n){"use strict";function r(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function s(t){r(o,a,i,s,c,"next",t)}function c(t){r(o,a,i,s,c,"throw",t)}s(void 0)}))}}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("../simpletons/api"),s=t("../simpletons/auth"),c=/[0-9a-zA-Z][\w]{3,23}/,u=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r,u,l;return e=t,(n=[{key:"getChannelSearch",value:(l=a(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!c.test(e)){t.next=4;break}return t.next=3,o.queryTwitchApi("helix/search/channels?query=".concat(e,"&first=10"),s.getAuthObj());case 3:return t.abrupt("return",t.sent);case 4:return t.abrupt("return",{});case 5:case"end":return t.stop()}}),t)}))),function(t){return l.apply(this,arguments)})},{key:"getChannelInfo",value:(u=a(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.queryTwitchApi("helix/streams?user_login=".concat(e),s.getAuthObj());case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(t){return u.apply(this,arguments)})}])&&i(e.prototype,n),r&&i(e,r),t}());e.exports=u},{"../simpletons/api":"tachikomas/api","../simpletons/auth":"tachikomas/auth"}],"tachikomas/twitchClient":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function s(t){r(o,a,i,s,c,"next",t)}function c(t){r(o,a,i,s,c,"throw",t)}s(void 0)}))}}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("tmi.js"),_="undefined"!=typeof window?window._:void 0!==n?n._:null,s=t("../models/events"),c=t("../helpers/signals").eventSignals,u=t("../helpers/constants"),l=t("../simpletons/auth"),h=t("../simpletons/api"),f=t("../simpletons/dataCache"),p=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._channel=void 0,this._channelID=void 0,this._enabled=!1,this.updateViewersCache=_.debounce(this._updateViewersCache.bind(this),500,{leading:!1}),this.saveChannel=_.debounce(this._saveChannel.bind(this),500,{leading:!1}),c.add(this._eventSignalFunc.bind(this))}var e,n,r,d,m,y,b,v;return e=t,(n=[{key:"_eventSignalFunc",value:function(t){switch(t.event){case"main.minute":t.filter.isValid()||this.updateViewersCache();break;case"stream.cleanup":this._disable();break;case"stream.load.ready":this._enable();break;case"channel.changed":this.changeChannel(t.channel)}}},{key:"initializeClient",value:(v=a(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!p._initPromise){t.next=3;break}return t.next=3,p._initPromise;case 3:if(!this._client){t.next=5;break}return t.abrupt("return");case 5:this.getChannel()||(localStorage.getItem("channel")?this._setChannel(localStorage.getItem("channel")):l.isBroadcaster()?(this._setChannel(l.getLogin()),this._setChannelID(l.getID())):this.changeChannel(u.DEFAULT_CHANNEL,u.DEFAULT_CHANNEL_ID)),this.getChannel()&&!this.getChannelID()&&(localStorage.getItem("channel-id")?this._setChannelID(parseInt(localStorage.getItem("channel-id"))):this._setChannelID()),this._client=new o.Client({connection:{secure:!0,reconnect:!0,maxReconnectInterval:1e3,reconnectInterval:1e3,reconnectDecay:1,timeout:5e3},channels:[this.getChannel()]}),this._client.on("chat",(function(t,n,r,a){e._processChatMessage(t,s.Chat,n)})),this._client.on("resub",(function(t,n,r,a,i,o){e._processChatMessage(t,s.ReSub,i,o,r)})),this._client.on("subscription",(function(t,n,r,a,i){e._processChatMessage(t,s.Sub,i,r,0)})),this._client.on("cheer",(function(t,n,r){e._processChatMessage(t,s.Cheer,n)})),this._client.on("ban",(function(t,n,r,a){e._processChatMessage(t,s.Ban,a)})),this._client.on("anongiftpaidupgrade",(function(t,n,r){e._processChatMessage(t,s.AnonGift,r)})),this._client.on("subgift",(function(t,n,r,a,i,o){e._processChatMessage(t,s.SubGift,o,i,r)})),this._client.on("submysterygift",(function(t,n,r,a,i){e._processChatMessage(t,s.MysterySubGift,i,a,r)})),this._client.connect(),c.dispatch({event:"channel.input.update",data:{id:this.getChannelID(),channe:this.getChannel()}}),this._initPromise=void 0;case 19:case"end":return t.stop()}}),t,this)}))),function(){return v.apply(this,arguments)})},{key:"changeChannel",value:(b=a(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.getChannel()!==e){t.next=2;break}return t.abrupt("return");case 2:return this.getChannel()&&this._client.part(this.getChannel()),this._setChannel(e),this._setChannelID(n),t.next=7,this._client.join(this.getChannel());case 7:this.updateViewersCache(),c.dispatch({event:"channel.input.update",data:{id:this.getChannelID(),channel:this.getChannel()}});case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return b.apply(this,arguments)})},{key:"_processChatMessage",value:function(t,e,n,r,a,i){var o=new e(n,r,a,i);"#"===t.charAt(0)?f.add(t.substring(1),o):f.add(t,o)}},{key:"_disable",value:function(){this._enabled=!1}},{key:"_enable",value:function(){this._enabled||(this._enabled=!0,this.updateViewersCache())}},{key:"_updateViewersCache",value:(y=a(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._enabled&&this.getChannel()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,h.queryTmiApi("group/user/".concat(this.getChannel(),"/chatters"));case 4:e=t.sent,c.dispatch({event:"chatters.data.update",data:e[u.KEY_CHATTERS],channelID:this.getChannelID()});case 6:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{key:"_setChannel",value:function(t){this._channel=t}},{key:"_setChannelID",value:(m=a(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}this._channelID=e,t.next=12;break;case 4:if(!this.getChannel()){t.next=11;break}return t.next=7,h.queryTwitchApi("kraken/users?login=".concat(this.getChannel()));case 7:n=t.sent,this._channelID=parseInt(n.users[0]._id),t.next=12;break;case 11:return t.abrupt("return");case 12:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"changeToRandomFeaturedStream",value:(d=a(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.queryTwitchApi("kraken/streams/featured?limit=100");case 3:e=t.sent,n=e.featured.filter((function(t){return t.stream.viewers>100&&t.stream.viewers<=u.MAX_VIEWERS_COUNTS_FOR_PROCESS})),r=n[Math.floor(Math.random()*n.length)],this.changeChannel(r.stream.channel.name,r.stream.channel._id),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),this.changeChannel("xqcow",71092938);case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return d.apply(this,arguments)})},{key:"getChannel",value:function(){return this._channel}},{key:"getChannelID",value:function(){return this._channelID}},{key:"_saveChannel",value:function(){localStorage.setItem("channel",this._channel),localStorage.setItem("channel-id",this._channelID),c.dispatch({alert:{type:"success",body:"Successfully saved channel"}})}}])&&i(e.prototype,n),r&&i(e,r),t}());p._initPromise=p.initializeClient(),e.exports=p}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../helpers/constants":"tachikomas/constants","../helpers/signals":"tachikomas/signals","../models/events":"tachikomas/events","../simpletons/api":"tachikomas/api","../simpletons/auth":"tachikomas/auth","../simpletons/dataCache":"tachikomas/dataCache","tmi.js":void 0}],"tachikomas/twitchEmbededVC":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("../../singletons/twitchClient"),i=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastSearchedChannel=void 0,this.embededTwitch=void 0,this.twitchEmbededCollapse=void 0,this.streamInfo=void 0,this.toggleEmbededTwitch=_.debounce(this._toggleEmbededTwitch.bind(this),1e3,{leading:!1}),t("../../helpers/signals").domSignals.add(this._domeEventFunction.bind(this))}var n,i,o;return n=e,(i=[{key:"_domeEventFunction",value:function(t){"click"===t.type&&"embeded-twitch-collapse"===t.id&&this.toggleEmbededTwitch()}},{key:"_getIsOpenTwitchEmbeded",value:function(){var t=localStorage.getItem("isOpenTwitchEmbeded");return!t||JSON.parse(t)}},{key:"_handleEmbededTwitch",value:function(){this._getIsOpenTwitchEmbeded()?this.embededTwitch=new Twitch.Embed("twitch-embed",{width:"100%",height:"100%",channel:a.getChannel(),autoplay:!0,muted:!0,allowfullscreen:!1}):this.embededTwitch&&this.embededTwitch.destroy()}},{key:"_toggleEmbededTwitch",value:function(){var t=document.getElementById("twitch-embed").classList.contains("show");localStorage.setItem("isOpenTwitchEmbeded",JSON.stringify(Boolean(t))),this._handleEmbededTwitch()}},{key:"initialize",value:function(){this.destroy();var t=document.getElementById("embeded-twitch-collapse");this.twitchEmbededCollapse=new BSN.Collapse(t),this._getIsOpenTwitchEmbeded()?this._handleEmbededTwitch():this.twitchEmbededCollapse.hide()}},{key:"destroy",value:function(){this.twitchEmbededCollapse&&(this.twitchEmbededCollapse.dispose(),this.twitchEmbededCollapse=void 0),this.embededTwitch&&(this.embededTwitch.destroy(),this.embededTwitch=void 0)}}])&&r(n.prototype,i),o&&r(n,o),e}();e.exports=new i},{"../../helpers/signals":"tachikomas/signals","../../singletons/twitchClient":"tachikomas/twitchClient"}],"tachikomas/userFilter":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("../../../singletons/users"),i=t("../../../singletons/twitchClient"),o=new(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.changeSearchString(e)}var e,n,o;return e=t,(n=[{key:"changeSearchString",value:function(t){this._searchString=this._getCleanedSearchString(t),":following"===this._searchString?this.isApplicable=this._isFollowing:":notfollowing"===this._searchString?this.isApplicable=this._isNotFollowing:0!==this._searchString.indexOf(":")&&this.isValid()?this.isApplicable=this._isStringIncluded:this.isApplicable=function(){return!0}}},{key:"_isFollowing",value:function(t){var e=a.getUserByName(t);if(e)return e.isFollowing(i.getChannelID())}},{key:"_isNotFollowing",value:function(t){var e=this._isFollowing(t);if(void 0!==e)return!e}},{key:"_isStringIncluded",value:function(t){return t.toLowerCase().indexOf(this._searchString)>-1}},{key:"_getCleanedSearchString",value:function(t){return(t||"").trim().toLowerCase()}},{key:"filterUsers",value:function(t){var e=this;return this.isValid()?t.filter((function(t){return e.isApplicable(t._userName)})):t}},{key:"isSameSearchString",value:function(t){return this._getCleanedSearchString(t)===this._searchString}},{key:"isValid",value:function(){return Boolean(this._searchString)}}])&&r(e.prototype,n),o&&r(e,o),t}());e.exports=o},{"../../../singletons/twitchClient":"tachikomas/twitchClient","../../../singletons/users":"tachikomas/users"}],"tachikomas/userFollowsFetcher":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _="undefined"!=typeof window?window._:void 0!==n?n._:null,i=t("../../simpletons/auth"),o=t("../../simpletons/api"),s=t("../../helpers/signals").eventSignals,c=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset(),this._paginations={},this.fetch=_.throttle(this._fetch,5e3)}var e,n,c,u,l;return e=t,(n=[{key:"reset",value:function(){this._toFetch=new Set,this._running=0,this._toFetchArray&&(this._toFetchArray.length=0),this._toFetchArray=void 0}},{key:"add",value:function(t){this._toFetch.add(t),this.fetch()}},{key:"_fetch",value:function(){if(this._toFetchArray=Array.from(this._toFetch),0!==this._toFetchArray.length)for(var t=this._running;t<5;t++)this._running++,this._fetchUserFollows()}},{key:"_fetchUserFollows",value:(u=regeneratorRuntime.mark((function t(){var e,n,r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.getAuthObj();case 2:e=t.sent;case 3:if((n=(this._toFetchArray||[]).shift())&&"done"!==this._paginations[n]){t.next=7;break}return this._toFetch.delete(n),t.abrupt("break",28);case 7:t.prev=7;case 8:return r="helix/users/follows?first=100&from_id=".concat(n),t.next=11,o.queryTwitchApi(this._paginations[n]?"".concat(r,"&after=").concat(this._paginations[n]):r,e);case 11:if(a=t.sent,s.dispatch({event:"fetch.user.follows.resp",data:a,userID:n}),a.pagination&&a.pagination.cursor){t.next=17;break}return this._paginations[n]="done",this._toFetch.delete(n),t.abrupt("break",20);case 17:this._paginations[n]=a.pagination.cursor;case 18:t.next=8;break;case 20:t.next=26;break;case 22:return t.prev=22,t.t0=t.catch(7),console.warn("failed to fetch user follows",t.t0),t.abrupt("break",28);case 26:t.next=3;break;case 28:this._running=Math.max(0,this._running-1);case 29:case"end":return t.stop()}}),t,this,[[7,22]])})),l=function(){var t=this,e=arguments;return new Promise((function(n,a){var i=u.apply(t,e);function o(t){r(i,n,a,o,s,"next",t)}function s(t){r(i,n,a,o,s,"throw",t)}o(void 0)}))},function(){return l.apply(this,arguments)})}])&&a(e.prototype,n),c&&a(e,c),t}());e.exports=c}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../helpers/signals":"tachikomas/signals","../../simpletons/api":"tachikomas/api","../../simpletons/auth":"tachikomas/auth"}],"tachikomas/userIDFetcher":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){i(o,r,a,s,c,"next",t)}function c(t){i(o,r,a,s,c,"throw",t)}s(void 0)}))}}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _="undefined"!=typeof window?window._:void 0!==n?n._:null,c=t("../../simpletons/auth"),u=t("../../simpletons/api"),l=t("../../helpers/signals").eventSignals,h=!1,f=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,a,i,f;return e=t,(n=[{key:"reset",value:function(){this._names=new Set,this.fetch=_.throttle(this._fetch,2e3)}},{key:"add",value:function(t){this._names.add(t),this.fetch()}},{key:"_fetch",value:(f=o(regeneratorRuntime.mark((function t(){var e,n,r,a,i,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!h){t.next=2;break}return t.abrupt("return");case 2:return h=!0,e=Array.from(this._names),t.next=6,c.getAuthObj();case 6:for(n=t.sent,r=[],a=0;a<e.length;a+=100)r.push(e.slice(a,a+100));t.prev=9,i=0,o=r;case 11:if(!(i<o.length)){t.next=18;break}return s=o[i],t.next=15,this._fetchUserIDsForNames(n,s);case 15:i++,t.next=11;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(9),console.warn("failed to query for ids",t.t0);case 23:h=!1;case 24:case"end":return t.stop()}}),t,this,[[9,20]])}))),function(){return f.apply(this,arguments)})},{key:"_fetchUserIDsForNames",value:(i=o(regeneratorRuntime.mark((function t(e,n){var a,i,o,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="helix/users?login=".concat(n.join("&login=")),t.next=3,u.queryTwitchApi(a,e);case 3:i=t.sent,o=r(i.data);try{for(o.s();!(s=o.n()).done;)c=s.value,this._names.delete(c.login.toLowerCase())}catch(t){o.e(t)}finally{o.f()}l.dispatch({event:"fetch.user.ids.resp",data:i.data});case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})}])&&s(e.prototype,n),a&&s(e,a),t}());e.exports=f}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../helpers/signals":"tachikomas/signals","../../simpletons/api":"tachikomas/api","../../simpletons/auth":"tachikomas/auth"}],"tachikomas/users":[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=t("../../helpers/signals").eventSignals,c=t("./User"),u=t("./userIDFetcher"),l=t("./userFollowsFetcher"),h=t("./channelFollowsFetcher"),f=t("../../helpers/constants"),p=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset(),s.add(this._eventSignalFunc.bind(this))}var e,n,i;return e=t,(n=[{key:"_eventSignalFunc",value:function(t){switch(t.event){case"chatters.data.update":this.processChattersData(t.data,t.channelID),s.dispatch({event:"chatters.data.update.data"});break;case"fetch.user.ids.resp":this.processUserIDsResp(t.data);break;case"fetch.user.follows.resp":this.processUserFollowsResp(t.userID,t.data);break;case"api.unthrottled":u.fetch(),l.fetch();break;case"channel.input.update":u.reset(),l.reset(),h.fetch(t.data.id);break;case"fetch.channel.follows.resp":this.processChannelFollows(t.channelID,t.data)}}},{key:"reset",value:function(){this._viewers={},this._idToUser={},this._nameToUser={},this._channelWarned={}}},{key:"getUserByID",value:function(t){return this._idToUser[t]}},{key:"getUserByName",value:function(t){return this._nameToUser[t]}},{key:"getViewers",value:function(){return this._viewers}},{key:"processChattersData",value:function(t,e){for(var n=this,a={},i=Object.values(t||{}).reduce((function(t,e){return e.length+t}),0),o=0,l=Object.entries(t||{});o<l.length;o++){var h=r(l[o],2),p=h[0],d=h[1];a[p]=d.sort().map((function(t){var e=t.toLowerCase();return n.getUserByName(e)||(n._nameToUser[e]=new c(void 0,t),i<f.MAX_VIEWERS_COUNTS_FOR_PROCESS&&u.add(t)),n.getUserByName(e)}))}i>=f.MAX_VIEWERS_COUNTS_FOR_PROCESS&&!this._channelWarned[e]&&(this._channelWarned[e]=!0,s.dispatch({alert:{type:"warning",body:"This channel has higher than ".concat(f.MAX_VIEWERS_COUNTS_FOR_PROCESS," viewers.  Halting some data gatherings to conserve API requests.")}})),this._viewers=a}},{key:"processUserFollowsResp",value:function(t,e){this.getUserByID(t).addFollows(e),s.dispatch({event:"chatters.data.update.partial"})}},{key:"processUserIDsResp",value:function(t){var e,n=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}(t);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r.login.toLowerCase();if(this.getUserByName(i)){var o=parseInt(r.id);this.getUserByName(i).setID(o),this._idToUser[o]=this.getUserByName(i),l.add(o)}}}catch(t){n.e(t)}finally{n.f()}}},{key:"processChannelFollows",value:function(t,e){var n=this;e.data.forEach((function(e){var r=e.from_id,a=e.from_name,i=a.toLowerCase(),o=n.getUserByName(i)||n.getUserByID(r)||new c(r,a);o.addFollows({data:[{to_id:t}]}),n._nameToUser[i]=o,n._idToUser[r]=o}))}}])&&o(e.prototype,n),i&&o(e,i),t}());e.exports=p},{"../../helpers/constants":"tachikomas/constants","../../helpers/signals":"tachikomas/signals","./User":"tachikomas/User","./channelFollowsFetcher":"tachikomas/channelFollowsFetcher","./userFollowsFetcher":"tachikomas/userFollowsFetcher","./userIDFetcher":"tachikomas/userIDFetcher"}],"tachikomas/utils":[function(t,e,n){"use strict";var moment=t("../helpers/moment"),r=t("./constants"),a=t("../models/events");e.exports={muteSeconds:function(t){return t.set({second:0,millisecond:0})},getTimeBucket:function(t,e){if(e==r.BUCKET_DAY){var n=moment.unix(t);return n.set({hour:0,minute:0,second:0,millisecond:0}),n.unix()}return t-t%e},extractTabObj:function(t){if(0===t.length)return{tab:r.TABS_OPTIONS[0],args:{}};var e=t.indexOf("?")>-1?t.indexOf("?"):t.length,n=t.substr(1,e-1).toLowerCase(),a=r.TABS_OPTIONS.indexOf(n)>-1?n:r.TABS_OPTIONS[0],i=new URLSearchParams(t.substr(n.length+1));return{tab:a,args:Object.fromEntries(i.entries())}},getNow:function(){return moment().set({second:0,millisecond:0})},getMessageType:function(t){switch(!0){case t instanceof a.AnonGift:return r.TYPE_ANONGIFT;case t instanceof a.Ban:return r.TYPE_BAN;case t instanceof a.Cheer:return r.TYPE_CHEER;case t instanceof a.Chat:return r.TYPE_CHAT;case t instanceof a.MysterySubGift:return r.TYPE_SUBMYSTERY;case t instanceof a.ReSub:return r.TYPE_RESUB;case t instanceof a.SubGift:return r.TYPE_SUBGIFT;case t instanceof a.Sub:return r.TYPE_SUB;default:throw"invalid object type: ".concat(t)}},getRaw:function(t,e){switch(parseInt(t)){case r.TYPE_ANONGIFT:return new a.AnonGift(e);case r.TYPE_BAN:return new a.Ban(e);case r.TYPE_CHEER:return new a.Cheer(e);case r.TYPE_CHAT:return new a.Chat(e);case r.TYPE_SUBMYSTERY:return new a.MysterySubGift(e);case r.TYPE_RESUB:return new a.ReSub(e);case r.TYPE_SUBGIFT:return new a.SubGift(e);case r.TYPE_SUB:return new a.Sub(e);default:throw"invalid message type: ".concat(t)}}}},{"../helpers/moment":"tachikomas/moment","../models/events":"tachikomas/events","./constants":"tachikomas/constants"}]},{},["tachikomas/env","tachikomas/chartFilter","tachikomas/userFilter","tachikomas/chattersTableVC","tachikomas/ChartRoot","tachikomas/chatsByUsersVC","tachikomas/Chatters","tachikomas/DateTime","tachikomas/followedStreamersVC","tachikomas/proceedsByTypesVC","tachikomas/proceedsByUsersVC","tachikomas/timeseriesVC","tachikomas/dateTimeRangeVC","tachikomas/stream","tachikomas/navOptionVC","tachikomas/twitchEmbededVC","tachikomas/constants","tachikomas/moment","tachikomas/signals","tachikomas/utils","tachikomas/main","tachikomas/AnonGift","tachikomas/Ban","tachikomas/Chat","tachikomas/Cheer","tachikomas/Common","tachikomas/events","tachikomas/MysterySubGift","tachikomas/ReSub","tachikomas/Sub","tachikomas/SubGift","tachikomas/api","tachikomas/auth","tachikomas/dataCache","tachikomas/blanks","tachikomas/DataBucket","tachikomas/DataChannel","tachikomas/DataNode","tachikomas/twitchAPI","tachikomas/twitchClient","tachikomas/channelFollowsFetcher","tachikomas/users","tachikomas/User","tachikomas/userFollowsFetcher","tachikomas/userIDFetcher"]);