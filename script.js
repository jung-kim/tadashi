require=function t(e,n,r){function i(o,s){if(!n[o]){if(!e[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[o]={exports:{}};e[o][0].call(l.exports,(function(t){return i(e[o][1][t]||t)}),l,l.exports,t,e,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({"tachikomas/AnonGift":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=a(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,t)}return n}(t("./Common"));e.exports=c},{"./Common":"tachikomas/Common"}],"tachikomas/Ban":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=a(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,t)}return n}(t("./Common"));e.exports=c},{"./Common":"tachikomas/Common"}],"tachikomas/ChartRoot":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,c,"next",t)}function c(t){r(o,i,a,s,c,"throw",t)}s(void 0)}))}}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("../../../helpers/signals").eventSignals,s=t("../../shared/chartFilter"),c=t("../../../singletons/twitchClient"),u=t("../../../helpers/utils"),l=t("../../../helpers/constants"),_="undefined"!=typeof window?window._:void 0!==n?n._:null,h=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._enabled=!1,this._chartDomSelector=e.chartDomSelector,this._title=e.title,this._helpContent=e.helpContent,this._type=e.type||"doughnut",this.update=_.throttle(i(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._update();case 2:n._chartObject.update();case 3:case"end":return t.stop()}}),t)}))),e.updateThrottleTime||500),o.add(this._eventSignalsFunc.bind(this))}var e,n,r,h;return e=t,(n=[{key:"_eventSignalsFunc",value:function(t){switch(t.event){case"channel.input.update":this.reset();break;case"stream.load.ready":this._enabled=!0,this.reset();break;case"stream.cleanup":this._enabled=!1;break;case"data.cache.updated":case"filter.change":this._enabled&&this.update()}}},{key:"_update",value:(h=i(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw"not implemented";case 1:case"end":return t.stop()}}),t)}))),function(){return h.apply(this,arguments)})},{key:"reset",value:function(){this._initializedChartObject()}},{key:"_getParameters",value:function(){for(var t=s.getStartTime().unix(),e=s.getEndTime().unix(),n=s.getIntervalLevel(),r=u.getTimeBucket(t,n),i=u.getTimeBucket(e,n),a=Math.floor((i-r)/n)+1;n!=l.BUCKET_DAY&&a>=250;){var o=l.INTERVAL_BUCKETS.indexOf(n);n=l.INTERVAL_BUCKETS[o+1],a=Math.floor((i-r)/n)+1}return s.setIntervalLevel(n),{interval:n,startBucket:r=u.getTimeBucket(t,n),endBucket:i=u.getTimeBucket(e,n),channel:c.getChannel(),filter:s.getUserFilter(),length:a}}},{key:"_initializedChartObject",value:function(){this._chartObject&&this._chartObject.destroy(),document.getElementById(this._chartDomSelector).innerHTML=templates["./hbs/stream/components/chart.hbs"](this),this._helpDom=new BSN.Popover(document.getElementById("".concat(this._chartDomSelector,"-help")),{title:this._title,content:this._helpContent,placement:"left"}),this._chartObject=new Chart(document.getElementById("canvas-".concat(this._chartDomSelector)),this._defaultChartOptions())}},{key:"_defaultChartOptions",value:function(){return{type:this._type,data:{labels:[],datasets:[{data:[],backgroundColor:[],borderColor:[],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:this._title,fontSize:18}},animation:{duartion:250},hover:{animationDuration:0},responsiveAnimationDuration:250}}}},{key:"_getRootLabels",value:function(){return this._chartObject.data.labels}},{key:"_getDataset",value:function(){return this._chartObject.data.datasets}}])&&a(e.prototype,n),r&&a(e,r),t}();e.exports=h}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/signals":"tachikomas/signals","../../../helpers/utils":"tachikomas/utils","../../../singletons/twitchClient":"tachikomas/twitchClient","../../shared/chartFilter":"tachikomas/chartFilter"}],"tachikomas/Chatters":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("../../shared/chartFilter"),a=templates["./hbs/stream/components/chatters-group.hbs"],o=templates["./hbs/stream/components/chatters-group-list.hbs"],s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._update(e,n),this.toPreviousPage=_.throttle(this._toPreviousPage.bind(this),200),this.toNextPage=_.throttle(this._toNextPage.bind(this),200),this.updateChattersList=_.throttle(this._updateChattersList.bind(this),2e3)}var e,n,s;return e=t,(n=[{key:"_update",value:function(t,e){this.allChatters=i.getUserFilter().filterUsers(e),this._validatePageNumber(),this._key=t,this._expandButton||(this._chatterContainerDom=document.getElementById("chatter-container").insertAdjacentHTML("beforeend",a(this._key)),this._expandButton=new BSN.Collapse(document.getElementById("".concat(this._key,"-expand")))),this.allChatters.length<=250?document.getElementById("".concat(this._key,"-paginator")).classList.add("d-none"):(document.getElementById("".concat(this._key,"-paginator")).classList.remove("d-none"),this._updatePaginationNumbers()),document.getElementById("".concat(this._key,"-count")).textContent=this.allChatters.length,this._updateChattersList()}},{key:"_validatePageNumber",value:function(){var t=Math.max(this._pageNumber||0,0);this._pageNumber=250*t>this.allChatters.length?0:t}},{key:"_updatePaginationNumbers",value:function(){this.allChatters.length>250&&(document.getElementById("".concat(this._key,"-pagination-numbers")).textContent="".concat(this.getLeftIndex()," ~ ").concat(this.getRightIndex()))}},{key:"_updateChattersList",value:function(){document.getElementById("".concat(this._key,"-list-chatters")).innerHTML=o(this._getPage())}},{key:"update",value:function(t){this._update(this._key,t)}},{key:"getLeftIndex",value:function(){return 250*this._pageNumber}},{key:"getRightIndex",value:function(){return Math.min(this.allChatters.length,this.getLeftIndex()+250)}},{key:"_getPage",value:function(){return this.allChatters.slice(this.getLeftIndex(),this.getRightIndex())}},{key:"_toNextPage",value:function(){250*(this._pageNumber+1)<this.allChatters.length&&(this._pageNumber++,this._updatePaginationNumbers(),this._updateChattersList())}},{key:"_toPreviousPage",value:function(){this._pageNumber-1>=0&&(this._pageNumber--,this._updatePaginationNumbers(),this._updateChattersList())}}])&&r(e.prototype,n),s&&r(e,s),t}();e.exports=s},{"../../shared/chartFilter":"tachikomas/chartFilter"}],"tachikomas/Chat":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=a(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,t)}return n}(t("./Common"));e.exports=c},{"./Common":"tachikomas/Common"}],"tachikomas/Cheer":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=a(n);function n(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(r=e.call(this,t)).bits=parseInt(t.bits||0),r}return n}(t("./Common"));e.exports=c},{"./Common":"tachikomas/Common"}],"tachikomas/Common":[function(t,e,n){"use strict";e.exports=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.userID=parseInt(e["user-id"]||e.userID),this.displayName=e["display-name"]||e.displayName,this.timestamp=parseInt(e["tmi-sent-ts"])||e.timestamp}},{}],"tachikomas/DataBucket":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("../../../helpers/constants"),a=t("./DataNode"),o=t("../../../helpers/utils"),s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e?(this[i.TYPE_CHAT]=e[i.TYPE_CHAT].getCopy(),this[i.TYPE_RESUB]=e[i.TYPE_RESUB].getCopy(),this[i.TYPE_CHEER]=e[i.TYPE_CHEER].getCopy(),this[i.TYPE_SUB]=e[i.TYPE_SUB].getCopy(),this[i.TYPE_BAN]=e[i.TYPE_BAN].getCopy(),this[i.TYPE_ANONGIFT]=e[i.TYPE_ANONGIFT].getCopy(),this[i.TYPE_SUBGIFT]=e[i.TYPE_SUBGIFT].getCopy(),this[i.TYPE_SUBMYSTERY]=e[i.TYPE_SUBMYSTERY].getCopy()):(this[i.TYPE_CHAT]=new a,this[i.TYPE_RESUB]=new a,this[i.TYPE_CHEER]=new a,this[i.TYPE_SUB]=new a,this[i.TYPE_BAN]=new a,this[i.TYPE_ANONGIFT]=new a,this[i.TYPE_SUBGIFT]=new a,this[i.TYPE_SUBMYSTERY]=new a)}var e,n,s;return e=t,(n=[{key:"add",value:function(t){this[o.getMessageType(t)].add(t)}},{key:"getCopy",value:function(){return new t(this)}},{key:"merge",value:function(t,e){var n=this;return Object.keys(e).forEach((function(r){n[r].merge(t,e[r])})),this}}])&&r(e.prototype,n),s&&r(e,s),t}();e.exports=s},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/utils":"tachikomas/utils","./DataNode":"tachikomas/DataNode"}],"tachikomas/DataChannel":[function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=t("../../../helpers/constants"),o=t("../../../helpers/utils"),s=t("./DataBucket"),c=t("./blanks"),u=function(){function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._cache=(r(e={},a.BUCKET_FIVE,{}),r(e,a.BUCKET_HOUR,{}),e),this._data={},this._updated=new Set}var e,n,u;return e=t,(n=[{key:"add",value:function(t){var e=Math.floor(t.timestamp/1e3),n=o.getTimeBucket(e,a.BUCKET_MIN),r=o.getTimeBucket(e,a.BUCKET_FIVE);this._updated.add(r),this._data[n]||(this._data[n]=new s),this._data[n].add(t)}},{key:"_getAt",value:function(t){var e=this._data[t];return Object.freeze(e||c.blankDataBucket)}},{key:"_validateCache",value:function(){var t=this;Array.from(this._updated).forEach((function(e){var n=o.getTimeBucket(e,a.BUCKET_FIVE),r=o.getTimeBucket(e,a.BUCKET_HOUR);delete t._cache[a.BUCKET_FIVE][n],delete t._cache[a.BUCKET_HOUR][r]})),this._updated.clear()}},{key:"_getFiveMinRange",value:function(t){if(!this._cache[a.BUCKET_FIVE][t]){for(var e=this._getAt(t).getCopy(),n=t+a.BUCKET_MIN;n<t+a.BUCKET_FIVE;n+=a.BUCKET_MIN)e.merge(void 0,this._getAt(n));this._cache[a.BUCKET_FIVE][t]=Object.freeze(e)}return this._cache[a.BUCKET_FIVE][t]}},{key:"_getHourRange",value:function(t){if(!this._cache[a.BUCKET_HOUR][t]){for(var e=this._getFiveMinRange(t).getCopy(),n=t+a.BUCKET_FIVE;n<t+a.BUCKET_HOUR;n+=a.BUCKET_FIVE)e.merge(void 0,this._getFiveMinRange(n));this._cache[a.BUCKET_HOUR][t]=Object.freeze(e)}return this._cache[a.BUCKET_HOUR][t]}},{key:"get",value:function(t,e,n){this._validateCache();for(var r=new s,i=t;i<e;)i%a.BUCKET_HOUR==0&&i+a.BUCKET_HOUR<=e?(r.merge(n,this._getHourRange(i)),i+=a.BUCKET_HOUR):i%a.BUCKET_FIVE==0&&i+a.BUCKET_FIVE<=e?(r.merge(n,this._getFiveMinRange(i)),i+=a.BUCKET_FIVE):(r.merge(n,this._getAt(i)),i+=a.BUCKET_MIN);return r}}])&&i(e.prototype,n),u&&i(e,u),t}();e.exports=u},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/utils":"tachikomas/utils","./DataBucket":"tachikomas/DataBucket","./blanks":"tachikomas/blanks"}],"tachikomas/DataNode":[function(t,e,n){"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._sum=e||0,this._users=n||{}}var e,n,o;return e=t,(n=[{key:"add",value:function(t){var e=t.bits?t.bits/100:1;this._sum+=e,this._users[t.displayName]=(this._users[t.displayName]||0)+e}},{key:"getCopy",value:function(){return new t(this._sum,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this._users))}},{key:"merge",value:function(t,e){var n=this;return e&&Object.keys(e._users).forEach((function(r){t&&!t.isApplicable(r)||(n._users[r]=(n._users[r]||0)+e._users[r],n._sum+=e._users[r])})),this}}])&&a(e.prototype,n),o&&a(e,o),t}();e.exports=o},{}],"tachikomas/DateTime":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("../../../helpers/signals").eventSignals,moment=t("../../../helpers/moment"),a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.dom=document.getElementById(e),this.timeSelector=flatpickr(this.dom,{dateFormat:"Y-m-d H:i",enableTime:!0,allowInput:!0,clickOpens:!0,time_24hr:!0,minDate:"2020-01-01 00:00",defaultDate:moment().toDate(),onValueUpdate:_.debounce((function(){return i.dispatch({event:"date.change"},1e3)}))})}var e,n,a;return e=t,(n=[{key:"get",value:function(){return moment(this.timeSelector.selectedDates[0])}},{key:"set",value:function(t){this.timeSelector.setDate([t.format("YYYY-MM-DD HH:mm")],!0)}},{key:"destroy",value:function(){this.timeSelector.destroy()}}])&&r(e.prototype,n),a&&r(e,a),t}();e.exports=a},{"../../../helpers/moment":"tachikomas/moment","../../../helpers/signals":"tachikomas/signals"}],"tachikomas/MysterySubGift":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=a(n);function n(t,r,i){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),delete(a=e.call(this,t,r,0)).months,delete a.totalMonths,a.numSubs=i||t.numbOfSubs,a}return n}(t("./Sub"));e.exports=c},{"./Sub":"tachikomas/Sub"}],"tachikomas/ReSub":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=a(n);function n(t,r,i){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,t,r,i)}return n}(t("./Sub"));e.exports=c},{"./Sub":"tachikomas/Sub"}],"tachikomas/SubGift":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=a(n);function n(t,r,i){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(a=e.call(this,t,i,r)).recipientDisplayName=t["msg-param-recipient-display-name"]||t.recipientDisplayName,a.recipientID=t["msg-param-recipient-id"]||t.recipientID,a}return n}(t("./Sub"));e.exports=c},{"./Sub":"tachikomas/Sub"}],"tachikomas/Sub":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=t("./Common"),u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=a(n);function n(t,r,i){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(a=e.call(this,t)).months=i||t.months,a.totalMonths=t["msg-param-cumulative-months"]||t.totalMonths,a.subType=r?function(t){if(t)return t.prime?"prime":t.planName}(r):t.subType,a.subRank=r?function(t){if(t)return t.plan}(r):t.subRank,a}return n}(c);e.exports=u},{"./Common":"tachikomas/Common"}],"tachikomas/User":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._id=e,this._userName=n,r&&(this._following=new Set(r)),i&&(this._followedBy=new Set(i))}var e,n,i;return e=t,(n=[{key:"getID",value:function(){return this._id}},{key:"getUserName",value:function(){return this._userName}},{key:"addFollowing",value:function(t){t&&(this._following||(this._following=new Set),this._following.add(t))}},{key:"addFollowedBy",value:function(t){t&&(this._followedBy||(this._followedBy=new Set),this._followedBy.add(t))}},{key:"getFollowingCounts",value:function(){return this._following?this._following.size:void 0}},{key:"getFollowedByCounts",value:function(){return this._followedBy?this._followedBy.size:void 0}},{key:"isFollowing",value:function(t){return this._following?this._following.has(t):void 0}},{key:"isFollowedBy",value:function(t){return this._followedBy?this._followedBy.has(t):void 0}}])&&r(e.prototype,n),i&&r(e,i),t}();e.exports=i},{}],"tachikomas/api":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,c,"next",t)}function c(t){r(o,i,a,s,c,"throw",t)}s(void 0)}))}}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("../env"),s=t("http-status-codes").StatusCodes,c=t("../helpers/signals").eventSignals,u="undefined"!=typeof window?window.pako:void 0!==n?n.pako:null,l=/[0-9a-zA-Z][\w]{3,23}/,h=Object.freeze({headers:{"Client-ID":o.CLIENT_ID,Accept:"application/vnd.twitchtv.v5+json"}}),f=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,r,f,p,d,m,y;return e=t,(n=[{key:"reset",value:function(){this.waitForReset=null}},{key:"_getThrottledSleepDuration",value:function(t){var e=parseInt(t.headers.get("Ratelimit-Reset"));return isNaN(e)?15:(e>15&&console.warn("reset at is larger than max : ".concat(e)),Math.min(e,15))}},{key:"_makeTwitchAPIQuery",value:(y=i(regeneratorRuntime.mark((function t(e,n){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.waitForReset){t.next=5;break}return t.next=3,this.waitForReset;case 3:c.dispatch({event:"api.unthrottled"}),this.waitForReset=null;case 5:return t.next=7,fetch(e,n||h);case 7:if(r=t.sent,0!==parseInt(r.headers.get("Ratelimit-Remaining")||10)&&r.status!==s.TOO_MANY_REQUESTS||this.waitForReset){t.next=14;break}throw i=this._getThrottledSleepDuration(r),console.warn("too many requests! sleeping for ".concat(i)),this.waitForReset=new Promise((function(t){setTimeout(t,1e3*i+5)})),{status:r.status,msg:"too many requests"};case 14:if(r.ok){t.next=17;break}throw console.warn("query failed!"),{status:r.status,msg:"query failed"};case 17:if(!(r.headers.get("Content-Type").indexOf("gzip")>-1)){t.next=26;break}return t.t0=JSON,t.t1=u,t.next=22,r.arrayBuffer();case 22:return t.t2=t.sent,t.t3={to:"string"},t.t4=t.t1.ungzip.call(t.t1,t.t2,t.t3),t.abrupt("return",t.t0.parse.call(t.t0,t.t4));case 26:return t.next=28,r.json();case 28:return t.abrupt("return",t.sent);case 29:case"end":return t.stop()}}),t,this)}))),function(t,e){return y.apply(this,arguments)})},{key:"queryTwitchApi",value:(m=i(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="".concat(o.TWITCH_ENDPOINT,"/").concat(e),t.abrupt("return",this._makeTwitchAPIQuery(r,n));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return m.apply(this,arguments)})},{key:"queryTmiApi",value:(d=i(regeneratorRuntime.mark((function t(e){var n,r,i,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(o.TMI_ENDPOINT,"/").concat(e),r=n.indexOf("127.0.0.1")>-1,i=r?n:"https://api.allorigins.win/get?url=".concat(encodeURIComponent(n)),t.next=5,fetch(i);case 5:return a=t.sent,t.next=8,a.json();case 8:return s=t.sent,t.abrupt("return",r?s:JSON.parse(s.contents));case 10:case"end":return t.stop()}}),t)}))),function(t){return d.apply(this,arguments)})},{key:"getChannelSearch",value:(p=i(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!l.test(e)){t.next=4;break}return t.next=3,this.queryTwitchApi("helix/search/channels?query=".concat(e,"&first=10"),n);case 3:return t.abrupt("return",t.sent);case 4:return t.abrupt("return",{});case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return p.apply(this,arguments)})},{key:"getChannelInfo",value:(f=i(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.queryTwitchApi("helix/streams?user-login=".concat(e),n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return f.apply(this,arguments)})}])&&a(e.prototype,n),r&&a(e,r),t}());e.exports=f}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../env":"tachikomas/env","../helpers/signals":"tachikomas/signals","http-status-codes":void 0}],"tachikomas/auth":[function(t,e,n){"use strict";function r(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,c,"next",t)}function c(t){r(o,i,a,s,c,"throw",t)}s(void 0)}))}}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("../env"),s=t("../helpers/signals").eventSignals,c=Object.freeze({profile_image_url:"https://static-cdn.jtvnw.net/user-default-pictures-uv/294c98b5-e34d-42cd-a8f0-140b72fba9b0-profile_image-300x300.png",login:"unknown-user"}),u="scope=user:read:email+bits:read+moderation:read+channel:read:subscriptions+analytics:read:games",l=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._initialize()}var e,n,r,l,h,f,p;return e=t,(n=[{key:"_initialize",value:(p=i(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{this._authToken=JSON.parse(localStorage.getItem("auth"))}catch(t){this._authToken=void 0,console.warn("failed to parse localstorage cache",t)}return t.next=3,this._postAuth();case 3:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"_setAuthToken",value:function(t){t&&(this._authToken=t,localStorage.setItem("auth",JSON.stringify(this._authToken)))}},{key:"_authWithSecret",value:(f=i(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o.CLIENT_SECRET){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,fetch("".concat(o.AUTH_ENDPOINT,"/oauth2/token?client_id=").concat(o.CLIENT_ID,"&client_secret=").concat(o.CLIENT_SECRET,"&grant_type=client_credentials&").concat(u),{method:"POST"});case 4:return e=t.sent,t.next=7,e.json();case 7:n=t.sent,this._setAuthToken(n.access_token);case 9:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"authenticate",value:(h=i(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isAuthenticated()){t.next=2;break}return t.abrupt("return");case 2:if(!e){t.next=6;break}this._setAuthToken(e.get("access_token")),t.next=12;break;case 6:if(!o.CLIENT_SECRET){t.next=11;break}return t.next=9,this._authWithSecret();case 9:t.next=12;break;case 11:return t.abrupt("return","".concat(o.AUTH_ENDPOINT,"/oauth2/authorize?client_id=").concat(o.CLIENT_ID,"&redirect_uri=").concat(o.REDIRECT_URL,"&response_type=token&").concat(u));case 12:return t.next=14,this._postAuth();case 14:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"_postAuth",value:(l=i(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isAuthenticated()){t.next=14;break}return t.prev=1,t.next=4,fetch("".concat(o.TWITCH_ENDPOINT,"/helix/users"),this.getAuthObj());case 4:return e=t.sent,t.next=7,e.json();case 7:(n=t.sent)&&(this._user=n.data[0]),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.warn("failed to fetch logged in user info: ".concat(t.t0));case 14:this._user||(this._user=c),s.dispatch({event:"draw.nav.auth"}),this.isBroadcaster()&&s.dispatch({event:"channel.changed",channel:this.getLogin()});case 17:case"end":return t.stop()}}),t,this,[[1,11]])}))),function(){return l.apply(this,arguments)})},{key:"isAuthenticated",value:function(){return Boolean(this._authToken)}},{key:"isBroadcaster",value:function(){return Boolean(this._user&&this._user.broadcaster_type&&""!==this._user.broadcaster_type)}},{key:"getLogin",value:function(){return this._user&&this._user.login}},{key:"getID",value:function(){return this._user&&this._user.id}},{key:"logout",value:function(){this._authToken=void 0,this._user=void 0,localStorage.removeItem("auth"),s.dispatch({event:"draw.nav.auth"})}},{key:"getAuthObj",value:function(){if(this.isAuthenticated())return{headers:{"Client-ID":o.CLIENT_ID,Accept:"application/vnd.twitchtv.v5+json",Authorization:"Bearer ".concat(this._authToken)}}}}])&&a(e.prototype,n),r&&a(e,r),t}());e.exports=l},{"../env":"tachikomas/env","../helpers/signals":"tachikomas/signals"}],"tachikomas/blanks":[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}var o=t("../../../helpers/constants"),s=t("./DataNode"),c=t("./DataBucket"),u=new(function(){function t(){r(this,t),this._sum=0,this._users={},Object.freeze(this)}return a(t,[{key:"merge",value:function(t){return t.getCopy()}},{key:"getCopy",value:function(){return new s(0,{})}}]),t}()),l=new(function(){function t(){r(this,t),this[o.TYPE_CHAT]=u,this[o.TYPE_RESUB]=u,this[o.TYPE_CHEER]=u,this[o.TYPE_SUB]=u,this[o.TYPE_BAN]=u,this[o.TYPE_ANONGIFT]=u,this[o.TYPE_SUBGIFT]=u,this[o.TYPE_SUBMYSTERY]=u,Object.freeze(this)}return a(t,[{key:"merge",value:function(t){return t.getCopy()}},{key:"getCopy",value:function(){var t=new c;return t[o.TYPE_CHAT]=new s,t[o.TYPE_RESUB]=new s,t[o.TYPE_CHEER]=new s,t[o.TYPE_SUB]=new s,t[o.TYPE_BAN]=new s,t[o.TYPE_ANONGIFT]=new s,t[o.TYPE_SUBGIFT]=new s,t[o.TYPE_SUBMYSTERY]=new s,t}}]),t}());e.exports.blankDataNode=u,e.exports.blankDataBucket=l},{"../../../helpers/constants":"tachikomas/constants","./DataBucket":"tachikomas/DataBucket","./DataNode":"tachikomas/DataNode"}],"tachikomas/channelFollowsFetcher":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _="undefined"!=typeof window?window._:void 0!==n?n._:null,a=t("../../simpletons/auth"),o=t("../../simpletons/api"),s=t("../../helpers/signals").eventSignals,c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._paginations={},this.fetch=_.throttle(this._fetch,5e3)}var e,n,c,u,l;return e=t,(n=[{key:"_fetch",value:(u=regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&"done"!==this._paginations[e]){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,a.getAuthObj();case 4:n=t.sent,t.prev=5;case 6:return r="helix/users/follows?first=100&to_id=".concat(e),t.next=9,o.queryTwitchApi(this._paginations[e]?"".concat(r,"&after=").concat(this._paginations[e]):r,n);case 9:if(i=t.sent,s.dispatch({event:"fetch.channel.follows.resp",data:i,channelID:e}),i.pagination&&i.pagination.cursor){t.next=14;break}return this._paginations[e]="done",t.abrupt("return");case 14:this._paginations[e]=i.pagination.cursor;case 15:t.next=6;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(5),console.warn("failed to fetch channel follows",t.t0);case 22:case"end":return t.stop()}}),t,this,[[5,19]])})),l=function(){var t=this,e=arguments;return new Promise((function(n,i){var a=u.apply(t,e);function o(t){r(a,n,i,o,s,"next",t)}function s(t){r(a,n,i,o,s,"throw",t)}o(void 0)}))},function(t){return l.apply(this,arguments)})}])&&i(e.prototype,n),c&&i(e,c),t}();e.exports=new c}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../helpers/signals":"tachikomas/signals","../../simpletons/api":"tachikomas/api","../../simpletons/auth":"tachikomas/auth"}],"tachikomas/chartFilter":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("../../../helpers/constants"),a=t("../../../helpers/signals").eventSignals,moment=t("../../../helpers/moment"),o=t("../../../helpers/utils"),s=t("./userFilter"),c=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,c;return e=t,(n=[{key:"reset",value:function(){this._start=moment().set("second",0).set("millisecond",0),this._end=moment().set("second",0).set("millisecond",0),this._searchValue=void 0,this._intervalLevel=i.BUCKET_MIN}},{key:"update",value:function(t){var e={};t.start&&(t.start=o.muteSeconds(t.start),this._start&&t.start.unix()===this._start.unix()||(this._start=t.start,e.start=this._start)),t.end&&(t.end=o.muteSeconds(t.end),this._end&&t.end.unix()===this._end.unix()||(this._end=t.end,e.end=this._end)),"searchValue"in t&&(s.isSameSearchString(t.searchValue)||(s.changeSearchString(t.searchValue),e.filter=s)),t.intervalLevel&&t.intervalLevel!==this._intervalLevel&&(this._intervalLevel=t.intervalLevel,e.intervalLevel=this._intervalLevel),Object.keys(e).length>0&&a.dispatch({event:"filter.change",changed:e})}},{key:"getStartTime",value:function(){return this._start}},{key:"getEndTime",value:function(){return this._end}},{key:"getUserFilter",value:function(){return s}},{key:"getIntervalLevel",value:function(){return this._intervalLevel}},{key:"setIntervalLevel",value:function(t){this._intervalLevel=t}}])&&r(e.prototype,n),c&&r(e,c),t}());e.exports=c},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/moment":"tachikomas/moment","../../../helpers/signals":"tachikomas/signals","../../../helpers/utils":"tachikomas/utils","./userFilter":"tachikomas/userFilter"}],"tachikomas/chatsByUsersVC":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=t("./ChartRoot"),p=t("../../../helpers/constants"),d=t("../../../simpletons/dataCache"),m=t("../../../helpers/utils"),y=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(f,t);var e,n,r,a,l,h=u(f);function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),h.call(this,{chartDomSelector:"pie-chats-by-users",title:"Chat Counts by User Name",helpContent:"<p>Chats grouped by user name</p>"})}return e=f,(n=[{key:"_update",value:(a=regeneratorRuntime.mark((function t(){var e,n,r,a,o,s,c,u,l,h,f,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getParameters();case 2:for(e=t.sent,n=e.channel,r=e.filter,a=e.startBucket,o=e.endBucket,s=this._getRootLabels(),c=this._getDataset(),u=c[0].data,l=d.get(n,a,o+p.BUCKET_MIN,r)[p.TYPE_CHAT],h=Object.entries(l._users).sort((function(t,e){var n=i(t,2)[1];return i(e,2)[1]-n})),f=Math.min(h.length,10),y=0;y<f;y++)s[y]=h[y][0],u[y]=h[y][1];s.length=f,u.length=f,c[0].backgroundColor=m.getBackgroundColor(s),c[0].borderColor=m.getBorderColor(s);case 18:case"end":return t.stop()}}),t,this)})),l=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=a.apply(t,e);function s(t){o(i,n,r,s,c,"next",t)}function c(t){o(i,n,r,s,c,"throw",t)}s(void 0)}))},function(){return l.apply(this,arguments)})}])&&s(e.prototype,n),r&&s(e,r),f}(f));e.exports=y},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/utils":"tachikomas/utils","../../../simpletons/dataCache":"tachikomas/dataCache","./ChartRoot":"tachikomas/ChartRoot"}],"tachikomas/chattersTableVC":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||i(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _="undefined"!=typeof window?window._:void 0!==n?n._:null,s=t("../shared/chartFilter"),c=t("../../singletons/users"),u=t("./components/Chatters"),l=["broadcaster","vips","moderators","staff","admins","global_mods","viewers"],h=templates["./hbs/stream/chatters.hbs"],f=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadChattersTable=_.debounce(this._loadChattersTable.bind(this)),this.onChattersSearchKeyUp=_.debounce((function(){s.update({searchValue:document.getElementById("chatters-search").value})}),1e3),t("../../helpers/signals").domSignals.add(this._domSignalsEvent.bind(this))}var n,a,f;return n=e,(a=[{key:"_domSignalsEvent",value:function(t){switch(t.type){case"click":if(t.id.endsWith("-page-right")){var e=t.id.replace("-page-right","");this._chatters[e].toNextPage()}else if(t.id.endsWith("-page-left")){var n=t.id.replace("-page-left","");this._chatters[n].toPreviousPage()}break;case"keyup":"chatters-search"===t.id&&this.onChattersSearchKeyUp()}}},{key:"_loadChattersTable",value:function(){this._chatters=this._chatters||{};var t,e=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}(Object.entries(c.getViewers())||{});try{for(e.s();!(t=e.n()).done;){var n=r(t.value,2),a=n[0],o=n[1];this._chatters[a]?this._chatters[a].update(o):this._chatters[a]=new u(a,o)}}catch(t){e.e(t)}finally{e.f()}}},{key:"initialize",value:function(){this.destroy(),document.getElementById("chatters-table").innerHTML=h(l),this.chattersAutocomplete=new Awesomplete(document.getElementById("chatters-search"),{minChars:1,maxItems:10,autoFirst:!0,list:[":following",":notfollowing"]}),this._helpDom=new BSN.Popover(document.getElementById("chatters-help"),{title:"Chatters View",content:"Displays current chatters in the channel refreshed at every minute.</br>\n            </br>\n            Chatters search can search via chatters name or any of the following flags.</br>\n            <ul>\n                <li><code>:following</code></li>\n                <li><code>:notfollowing</code></li>\n            </ul>",placement:"left"})}},{key:"updateChattersList",value:function(){for(var t in this._chatters)this._chatters[t].updateChattersList()}},{key:"destroy",value:function(){this.bsnChattersSearch&&(this.bsnChattersSearch.dispose(),this.bsnChattersSearch=void 0)}}])&&o(n.prototype,a),f&&o(n,f),e}();e.exports=new f}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../helpers/signals":"tachikomas/signals","../../singletons/users":"tachikomas/users","../shared/chartFilter":"tachikomas/chartFilter","./components/Chatters":"tachikomas/Chatters"}],"tachikomas/constants":[function(t,e,n){"use strict";e.exports=Object.freeze({TYPE_CHAT:0,TYPE_RESUB:1,TYPE_CHEER:2,TYPE_SUB:3,TYPE_BAN:4,TYPE_ANONGIFT:5,TYPE_SUBGIFT:6,TYPE_SUBMYSTERY:7,NUM_TYPES:8,CHART_LABEL:["chat","re-subscription","cheer","subscription","ban","anonymous gift","subscription gift","subscription mystery"],CHART_BACKGROUND_COLOR:["rgb(255, 255, 0, 0.3)","rgb(153, 255, 51, 0.3)","rgb(51, 255, 255, 0.3)","rgb(0, 128, 225, 0.3)","rgb(255, 51, 153, 0.3)","rgb(102, 0, 204, 0.3)","rgb(255, 128, 0, 0.3)","rgb(128, 128, 128, 0.3)"],CHART_BORDER_COLOR:["rgb(255, 255, 0, 1.0)","rgb(153, 255, 51, 1.0)","rgb(51, 255, 255, 1.0)","rgb(0, 128, 225, 1.0)","rgb(255, 51, 153, 1.0)","rgb(102, 0, 204, 1.0)","rgb(255, 128, 0, 1.0)","rgb(128, 128, 128, 1.0)"],BUCKET_MIN:60,BUCKET_FIVE:300,BUCKET_HOUR:3600,BUCKET_DAY:86400,INTERVAL_BUCKETS:[60,300,3600,86400],TABS_OPTIONS:["stream"],CSS_UNKNOWN:"text-muted",CSS_FOLLOWING:"stream-following",CSS_NOT_FOLLOWING:"stream-not-following",MAX_VIEWERS_COUNTS_FOR_PROCESS:1e3})},{}],"tachikomas/dataCache":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("./models/DataChannel"),a=t("../../helpers/signals").eventSignals,o=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,o;return e=t,(n=[{key:"reset",value:function(){this._data={}}},{key:"_isValidRaw",value:function(t){return t.displayName?!!t.timestamp||(console.warn("missing timestamp",t),!1):(console.warn("missing displayname",t),!1)}},{key:"_ensureChannelExists",value:function(t){this._data[t]||(this._data[t]=new i)}},{key:"add",value:function(t,e){this._isValidRaw(e)&&(this._ensureChannelExists(t),this._data[t].add(e),a.dispatch({event:"data.cache.updated"}))}},{key:"get",value:function(t,e,n,r){return this._ensureChannelExists(t),this._data[t].get(e,n,r)}}])&&r(e.prototype,n),o&&r(e,o),t}());e.exports=o},{"../../helpers/signals":"tachikomas/signals","./models/DataChannel":"tachikomas/DataChannel"}],"tachikomas/dateTimeRangeVC":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("../../helpers/utils"),a=t("./components/DateTime"),o=t("../shared/chartFilter"),s=new(function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultStart=i.getNow(),this.isLive=!0,window.addEventListener("focus",this._onWindowFocus.bind(this)),t("../../helpers/signals").domSignals.add(this._domSignalsFunc.bind(this))}var n,s,c;return n=e,(s=[{key:"_domSignalsFunc",value:function(t){"click"===t.type&&"time-reset"===t.id&&this._timeReset()}},{key:"_isValid",value:function(){return Boolean(this.start&&this.end)}},{key:"_setIsLive",value:function(){var t=this.end.get().unix()-i.getNow().add(-1,"minutes").unix();this.isLive=t>=0&&t<=60}},{key:"_timeReset",value:function(){this.start.set(this.defaultStart),this.end.set(i.getNow())}},{key:"_onWindowFocus",value:function(){this.isLive&&this._isValid()&&this._timeReset()}},{key:"setDate",value:function(){if(this._isValid()){var t=this.start.get(),e=this.end.get();if(e.unix()<t.unix())return this.start.set(e),void this.end.set(t);this._setIsLive(),o.update({start:t,end:e})}}},{key:"minProgressed",value:function(){this.isLive&&this._isValid()&&this.end.set(i.getNow())}},{key:"initialize",value:function(){this.destroy(),document.getElementById("time-selectors").innerHTML=templates["./hbs/stream/date-time-range.hbs"](),this.start=new a("time-start"),this.end=new a("time-end"),new BSN.Popover(document.getElementById("time-help"),{title:"Date range",content:"Data display time window.",delay:500,placement:"bottom"}),new BSN.Popover(document.getElementById("time-reset-help"),{title:"Reset time",content:"Reset time window to page load time to now",delay:500,placement:"bottom"})}},{key:"destroy",value:function(){this.start&&(this.start.destroy(),this.start=void 0),this.end&&(this.end.destroy(),this.end=void 0)}}])&&r(n.prototype,s),c&&r(n,c),e}());e.exports=s},{"../../helpers/signals":"tachikomas/signals","../../helpers/utils":"tachikomas/utils","../shared/chartFilter":"tachikomas/chartFilter","./components/DateTime":"tachikomas/DateTime"}],"tachikomas/env":[function(t,e,n){"use strict";e.exports={ENVIRONMENT:"prod",HOST_ENDPOINT:"https://jung-kim.github.io/tadashi",TWITCH_ENDPOINT:"https://api.twitch.tv",AUTH_ENDPOINT:"https://id.twitch.tv",TMI_ENDPOINT:"https://tmi.twitch.tv",REDIRECT_URL:"https://jung-kim.github.io/tadashi/index.html",SERVICE:"tachikomas",CLIENT_ID:"nrmkyj3jbq4eukbuunluz5yygi9t7v",GIT_HASH:"b630474",TAG:"b630474"}},{}],"tachikomas/events":[function(t,e,n){"use strict";e.exports={AnonGift:t("./AnonGift"),Ban:t("./Ban"),Cheer:t("./Cheer"),Chat:t("./Chat"),MysterySubGift:t("./MysterySubGift"),ReSub:t("./ReSub"),SubGift:t("./SubGift"),Sub:t("./Sub")}},{"./AnonGift":"tachikomas/AnonGift","./Ban":"tachikomas/Ban","./Chat":"tachikomas/Chat","./Cheer":"tachikomas/Cheer","./MysterySubGift":"tachikomas/MysterySubGift","./ReSub":"tachikomas/ReSub","./Sub":"tachikomas/Sub","./SubGift":"tachikomas/SubGift"}],"tachikomas/followedStreamersVC":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=u(t);if(e){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=t("../../shared/chartFilter"),h=t("./ChartRoot"),f=t("../../../singletons/users"),p=t("../../../singletons/twitchClient"),d=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(h,t);var e,n,r,c=s(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),c.call(this,{type:"bar",title:"Top followed streamers by viewers",chartDomSelector:"pie-followed-streamers",helpContent:"<p>Top 19 followed streamers from viewers<br>\nIncludes data from both current viewers and the viewers who have left as well.\n</br></br>\n- followed by admirers: number of another stream is followed from current stream viewers who are not following current streamer.</br>\n- Followed by followers: number of another stream is followed from current stream viewers who are following current streamer.</br>\n- unknown: data hasn't beent fetched yet and is unkonwn.\n</p>",updateThrottleTime:5e3})}return e=h,(n=[{key:"_eventSignalsFunc",value:function(t){switch(t.event){case"channel.input.update":this.reset();break;case"stream.load.ready":this._enabled=!0,this.reset();break;case"stream.cleanup":this._enabled=!1;break;case"fetch.user.follows.resp":this._enabled&&(this.update(),this._chartObject.update())}}},{key:"_defaultChartOptions",value:function(){var t=a(u(h.prototype),"_defaultChartOptions",this).call(this);return t.data.datasets=[{data:[],backgroundColor:"#B346A3",borderColor:"#B34650",borderWidth:1,label:"followed by admirers"},{data:[],backgroundColor:"#46B356",borderColor:"#46B380",borderWidth:1,label:"followed by followers"},{data:[],backgroundColor:"#466DB3",borderColor:"#466D80",borderWidth:1,label:"unknown"}],t.options.indexAxis="y",t.options.scales={x:{stacked:!0},y:{stacked:!0}},t}},{key:"_update",value:function(){for(var t=p.getChannelID(),e=l.getUserFilter(),n=f.getTopFollowedBySummary(t,e),r=this._getRootLabels(),i=this._getDataset(),a=0;a<n.length;a++)r[a]=f.getUserByID(n[a].userID).getUserName();i[0].data=n.map((function(t){return t.admiring})),i[1].data=n.map((function(t){return t.following})),i[2].data=n.map((function(t){return t.unknown}))}}])&&i(e.prototype,n),r&&i(e,r),h}(h));e.exports=d},{"../../../singletons/twitchClient":"tachikomas/twitchClient","../../../singletons/users":"tachikomas/users","../../shared/chartFilter":"tachikomas/chartFilter","./ChartRoot":"tachikomas/ChartRoot"}],"tachikomas/main":[function(t,e,n){"use strict";function r(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,c,"next",t)}function c(t){r(o,i,a,s,c,"throw",t)}s(void 0)}))}}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("./helpers/signals").eventSignals,s=t("./helpers/signals").domSignals,c=t("./helpers/utils"),u=t("./helpers/constants"),moment=t("./helpers/moment"),l=t("./singletons/twitchClient"),h=t("./simpletons/auth"),f=t("./singletons/users"),p=t("./events/shared/chartFilter"),d="cir-active",m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentConnectivityLevel=void 0,this.activityStatusDom=document.getElementById("activity-status"),this.updateLatestProcessTime=_.throttle(this._updateLatestProcessTime.bind(this),1e3),this._latestProcessTime=0,o.add(this._eventSignalFunc.bind(this))}var e,n,r;return e=t,(n=[{key:"_eventSignalFunc",value:function(t){t.alert&&t.alert.body?(document.getElementById("alerts").insertAdjacentHTML("afterbegin",templates["./hbs/shared/alerts.hbs"](t.alert)),new BSN.Alert(document.querySelector(".alert"))):"draw.nav.auth"===t.event?(this.configureAuthView(),this.configureConnectivityStatus()):"data.cache.updated"===t.event?(this.configureConnectivityStatus(),this.updateLatestProcessTime()):"draw.nav.actvitiy-status"===t.event&&this.configureConnectivityStatus()}},{key:"getNearestId",value:function(t){return t.id?t.id:t.parentElement?this.getNearestId(t.parentElement):"undefined"}},{key:"getConnectivityLevel",value:function(){return l.isConnected()?h.isAuthenticated()?d:"cir-active-no-auth":"cir-inactive"}},{key:"configureAuthView",value:function(){document.getElementById("nav-auth").innerHTML=templates["./hbs/components/nav-auth.hbs"](h)}},{key:"_updateLatestProcessTime",value:function(){this._latestProcessTime=moment.now()}},{key:"getLatestProcessTimeMS",value:function(){return this._latestProcessTime}},{key:"configureConnectivityStatus",value:function(){var t=this.getConnectivityLevel();if(this.currentConnectivityLevel!==t){switch(t){case d:this.activityStatusDom.className="blink circle ".concat(d);break;case"cir-inactive":this.activityStatusDom.className="circle ".concat("cir-inactive");break;case"cir-active-no-auth":this.activityStatusDom.className="blink circle ".concat("cir-active-no-auth")}this.currentConnectivityLevel=t}}},{key:"userFollowsCSS",value:function(t){var e=f.getUserByName(t);if(!e)return u.CSS_UNKNOWN;var n=e.isFollowing(l.getChannelID());return!1===n?u.CSS_NOT_FOLLOWING:n?u.CSS_FOLLOWING:u.CSS_UNKNOWN}},{key:"activityStatusPopover",value:function(){var t,e;switch(this.getConnectivityLevel()){case"cir-inactive":e="Disconnected",t="Data collection is halted";break;case"cir-active-no-auth":e="Connected with no Auth",t="Data collection is limited";break;case d:e="Connected",t="Data is being collected"}t+="</br>Last data collection: ".concat(moment(this.getLatestProcessTimeMS()).format("YYYY-MM-DD HH:mm:ss")),document.getElementsByClassName("popover-header")[0].innerHTML=e,document.getElementsByClassName("popover-body")[0].innerHTML=t}}])&&a(e.prototype,n),r&&a(e,r),t}();window.env=t("./env.js"),window.onload=i(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.location&&window.location.hash&&(e=new URLSearchParams(window.location.hash.substr(1)),h.authenticate(e)),t.next=3,l.initializeClient();case 3:y.configureConnectivityStatus(),y.configureAuthView(),new BSN.Popover(y.activityStatusDom,{title:" ",content:" ",placement:"bottom"}),y.activityStatusDom.addEventListener("shown.bs.popover",y.activityStatusPopover.bind(y)),o.dispatch({event:"stream.load"}),window.setMinTopTimeoutEvent();case 9:case"end":return t.stop()}}),t)}))),window.authenticate=i(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.authenticate();case 2:(e=t.sent)&&(window.location=e);case 4:case"end":return t.stop()}}),t)}))),window.authLogout=function(){h.logout()},window.minuteEventDispatcher=function(){o.dispatch({event:"main.minute",channel:l.getChannel(),filter:p.getUserFilter()}),window.setMinTopTimeoutEvent()},window.setMinTopTimeoutEvent=function(){var t=c.getNow().add(1,"minute").valueOf()-moment.now();window.minTopTimeoutEvent=setTimeout(o.dispatch.bind(o,{event:"main.minute.top"}),t+5)},window.minuteEventInterval=setInterval(window.minuteEventDispatcher,6e4),window.domEvent=function(t,e){s.dispatch({id:e||y.getNearestId(t.target),type:t.type,event:t})};var y=new m;Handlebars.registerHelper("userFollowsCSS",y.userFollowsCSS),e.exports=y},{"./env.js":"tachikomas/env","./events/shared/chartFilter":"tachikomas/chartFilter","./helpers/constants":"tachikomas/constants","./helpers/moment":"tachikomas/moment","./helpers/signals":"tachikomas/signals","./helpers/utils":"tachikomas/utils","./simpletons/auth":"tachikomas/auth","./singletons/twitchClient":"tachikomas/twitchClient","./singletons/users":"tachikomas/users"}],"tachikomas/moment":[function(t,e,n){"use strict";var r;try{r=moment}catch(e){r=t("moment-timezone")}e.exports=r},{"moment-timezone":void 0}],"tachikomas/navOptionVC":[function(t,e,n){"use strict";function r(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,c,"next",t)}function c(t){r(o,i,a,s,c,"throw",t)}s(void 0)}))}}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("../../helpers/signals").eventSignals,s=t("../../singletons/twitchClient"),c=t("../../simpletons/auth"),u=t("../../simpletons/api"),l=t("../../helpers/constants"),h=t("../shared/chartFilter"),f=function(){function e(){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.channelInputAutoComplete=void 0,this.toDsipose=[],this.fetchList=_.debounce(this._fetchList.bind(this),500,{leading:!1}),this.streamSelect=_.debounce(this._streamSelect.bind(this),500,{leading:!1}),this.populateStreamInfo=_.debounce(this._populateStreamInfo.bind(this),500,{leading:!1}),this.syncChannelInput=_.debounce((function(){n.channelInputAutoComplete.input.value=s.getChannel()}),250,{leading:!1}),t("../../helpers/signals").domSignals.add(this._domSignalsFunc.bind(this))}var n,r,f,p,d,m;return n=e,(r=[{key:"_domSignalsFunc",value:function(t){if("click"===t.type&&t.id.endsWith("-interval"))this._intervalClickEvent(t.event);else if("channel-input"===t.id)switch(t.type){case"keyup":this._onChannelInputKeyUp(t.event);break;case"click":this._refreshList();break;case"focusout":case"channel.input.update":this.syncChannelInput()}else if("channel-refresh"===t.id)switch(t.type){case"click":s.changeToRandomFeaturedStream()}else if("channel-save"===t.id)switch(t.type){case"click":s.saveChannel()}}},{key:"_onChannelInputKeyUp",value:function(t){if(13===t.keyCode||t.awesompleteSelect)return this.lastSearchedChannel=this.channelInputAutoComplete.input.value,void this.streamSelect();this._refreshList()}},{key:"_refreshList",value:function(){var t=this.channelInputAutoComplete.input.value;this.lastSearchedChannel!==t?(this.lastSearchedChannel=t,this.fetchList()):this.channelInputAutoComplete.open()}},{key:"_fetchList",value:(m=i(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.getChannelSearch(this.lastSearchedChannel,c.getAuthObj());case 2:e=t.sent,this.channelInputAutoComplete.list=(e.data||[]).map((function(t){return t.display_name}));case 4:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)})},{key:"_streamSelect",value:(d=i(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.changeChannel(this.lastSearchedChannel);case 3:this.populateStreamInfo(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),o.dispatch({alert:{type:"warning",body:"Requested ".concat(this.lastSearchedChannel," is not a valid channel.")}});case 9:this.channelInputAutoComplete.close();case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return d.apply(this,arguments)})},{key:"_populateStreamInfo",value:(p=i(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.getChannel(),this.channelInputAutoComplete.input.value=this.lastSearchedChannel||e,document.getElementById("embeded-twitch-channel").innerText=e,t.prev=3,t.next=6,u.getChannelInfo(e,c.getAuthObj());case 6:this.streamInfo=t.sent,this.streamInfo&&this.streamInfo.data&&this.streamInfo.data.length>0?document.getElementById("embeded-twitch-desc").innerHTML="".concat(this.streamInfo.data[0].title):document.getElementById("embeded-twitch-desc").innerHTML="(inactive...)",t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),document.getElementById("embeded-twitch-desc").innerHTML="".concat(e,"'s stream");case 13:case"end":return t.stop()}}),t,this,[[3,10]])}))),function(){return p.apply(this,arguments)})},{key:"_intervalClickEvent",value:function(t){var e=t.srcElement.innerHTML;switch(e){case"1 minute":h.update({intervalLevel:l.BUCKET_MIN});break;case"5 minutes":h.update({intervalLevel:l.BUCKET_FIVE});break;case"1 hour":h.update({intervalLevel:l.BUCKET_HOUR});break;case"1 day":h.update({intervalLevel:l.BUCKET_DAY})}document.getElementById("interval-selector-btn").innerText=e}},{key:"initialize",value:function(){this.destroy(),document.getElementById("nav-options").innerHTML=templates["./hbs/stream/nav-options.hbs"](),this.toDsipose.push(new BSN.Dropdown(document.getElementById("interval-selector"))),this.toDsipose.push(new BSN.Popover(document.getElementById("interval-selector-help"),{title:"Timeseries interval level",content:"Select timeseries interval level.",delay:500,placement:"bottom"})),this.toDsipose.push(new BSN.Popover(document.getElementById("channel-refresh-help"),{title:"Randomize channel",content:"Randomize channel based on featured streams API call.",delay:500,placement:"bottom"})),this.toDsipose.push(new BSN.Popover(document.getElementById("channel-save-help"),{title:"Save channel",content:"Cache channel to be used on next page time page loads.",delay:500,placement:"bottom"})),this.channelInputAutoComplete=new Awesomplete(document.getElementById("channel-input"),{minChars:4,maxItems:10,autoFirst:!0}),this.channelInputAutoComplete.input.addEventListener("awesomplete-selectcomplete",this._onChannelInputKeyUp.bind(this))}},{key:"destroy",value:function(){this.channelInputAutoComplete&&(this.channelInputAutoComplete.destroy(),this.channelInputAutoComplete=void 0),this.toDsipose.forEach((function(t){return t.dispose()})),this.toDsipose.length=0}}])&&a(n.prototype,r),f&&a(n,f),e}();e.exports=new f},{"../../helpers/constants":"tachikomas/constants","../../helpers/signals":"tachikomas/signals","../../simpletons/api":"tachikomas/api","../../simpletons/auth":"tachikomas/auth","../../singletons/twitchClient":"tachikomas/twitchClient","../shared/chartFilter":"tachikomas/chartFilter"}],"tachikomas/proceedsByTypesVC":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=l(t);if(e){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=t("./ChartRoot"),f=t("../../../helpers/constants"),p=t("../../../simpletons/dataCache"),d=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(m,t);var e,n,r,u,h,d=c(m);function m(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),(t=d.call(this,{type:"bar",chartDomSelector:"pie-proceeds",title:"Overall Proceeds",helpContent:"<p>Proceeds by type<br>\n<ul>\n<li>100 Cheers count</li>\n<li>Subscription count</li>\n<li>Re-Subscription count</li>\n<li>Subscription Gifts count</li>\n<li>Mystery Subscription count</li>\n</ul>\n</p>"}))._labels=Object.freeze(["100 Cheer","Subs","Resubs","Sub Gifts","Sub Mystery"]),t._messageTypes=Object.freeze([f.TYPE_CHEER,f.TYPE_SUB,f.TYPE_RESUB,f.TYPE_SUBGIFT,f.TYPE_SUBMYSTERY]),t._backgroundColor=Object.freeze(t._messageTypes.map((function(t){return f.CHART_BACKGROUND_COLOR[t]}))),t._borderColor=Object.freeze(t._messageTypes.map((function(t){return f.CHART_BORDER_COLOR[t]}))),t}return e=m,(n=[{key:"_update",value:(u=regeneratorRuntime.mark((function t(){var e,n,r,i,a,o,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getParameters();case 2:e=t.sent,n=e.channel,r=e.filter,i=e.startBucket,a=e.endBucket,o=this._getDataset(),s=o[0].data,c=p.get(n,i,a+f.BUCKET_MIN,r),s[0]=c[f.TYPE_CHEER]._sum,s[1]=c[f.TYPE_SUB]._sum,s[2]=c[f.TYPE_RESUB]._sum,s[3]=c[f.TYPE_SUBGIFT]._sum,s[4]=c[f.TYPE_SUBMYSTERY]._sum;case 15:case"end":return t.stop()}}),t,this)})),h=function(){var t=this,e=arguments;return new Promise((function(n,r){var a=u.apply(t,e);function o(t){i(a,n,r,o,s,"next",t)}function s(t){i(a,n,r,o,s,"throw",t)}o(void 0)}))},function(){return h.apply(this,arguments)})},{key:"_defaultChartOptions",value:function(){var t=o(l(m.prototype),"_defaultChartOptions",this).call(this);return t.data.labels=this._labels,t.data.datasets[0].backgroundColor=this._backgroundColor,t.data.datasets[0].borderColor=this._borderColor,t}}])&&a(e.prototype,n),r&&a(e,r),m}(h));e.exports=d},{"../../../helpers/constants":"tachikomas/constants","../../../simpletons/dataCache":"tachikomas/dataCache","./ChartRoot":"tachikomas/ChartRoot"}],"tachikomas/proceedsByUsersVC":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f(t);if(e){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=t("./ChartRoot"),d=t("../../../helpers/constants"),m=t("../../../simpletons/dataCache"),y=t("../../../helpers/utils"),v=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(v,t);var e,n,r,a,h,p=l(v);function v(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),(t=p.call(this,{chartDomSelector:"pie-proceeds-by-users",title:"Proceeds by User Name",helpContent:"<p>Proceeds by users<br>\n<ul>\n<li>100 Cheers</li>\n<li>Subscription count</li>\n<li>Re-Subscription count</li>\n<li>Subscription Gifts count</li>\n<li>Mystery Subscription count</li>\n</ul>\n</p>"}))._proceedsTypesToProcess=Object.freeze([d.TYPE_CHEER,d.TYPE_SUB,d.TYPE_RESUB,d.TYPE_SUBGIFT,d.TYPE_SUBMYSTERY]),t._displayLimit=10,t}return e=v,(n=[{key:"reset",value:function(){c(f(v.prototype),"reset",this).call(this),this._sumByType=[]}},{key:"_update",value:(a=regeneratorRuntime.mark((function t(){var e,n,r,a,o,s,c,u,l,h,f,p,v,b,g=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getParameters();case 2:for(e=t.sent,n=e.channel,r=e.filter,a=e.startBucket,o=e.endBucket,s=m.get(n,a,o+d.BUCKET_MIN,r),c=this._proceedsTypesToProcess.reduce((function(t,e){return t?t.merge(void 0,s[e]):s[e].getCopy()}),null),u=Object.entries(c._users).sort((function(t,e){var n=i(t,2)[1];return i(e,2)[1]-n})),l=Math.min(u.length,this._displayLimit),h=this._getRootLabels(),f=this._getDataset(),p=f[0].data,v=function(t){var e=u[t][0];h[t]=e,p[t]=u[t][1],g._sumByType[t]=g._proceedsTypesToProcess.reduce((function(t,n){var r=s[n]._users[e];return r&&(t[n]=r),t}),{})},b=0;b<l;b++)v(b);h.length=l,p.length=l,this._sumByType.length=l,f[0].backgroundColor=y.getBackgroundColor(h),f[0].borderColor=y.getBorderColor(h);case 21:case"end":return t.stop()}}),t,this)})),h=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=a.apply(t,e);function s(t){o(i,n,r,s,c,"next",t)}function c(t){o(i,n,r,s,c,"throw",t)}s(void 0)}))},function(){return h.apply(this,arguments)})},{key:"_afterLabel",value:function(t){var e=this._chartObject.data.labels.indexOf(t),n=this._sumByType[e];return Object.keys(n||{}).map((function(t){var e=n[t];return"  ".concat(d.CHART_LABEL[t],": ").concat(t==d.TYPE_CHEER?100*e:e)}))}},{key:"_defaultChartOptions",value:function(){var t=c(f(v.prototype),"_defaultChartOptions",this).call(this);return t.options.plugins.tooltip={callbacks:{afterLabel:this._afterLabel.bind(this)}},t}}])&&s(e.prototype,n),r&&s(e,r),v}(p));e.exports=v},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/utils":"tachikomas/utils","../../../simpletons/dataCache":"tachikomas/dataCache","./ChartRoot":"tachikomas/ChartRoot"}],"tachikomas/signals":[function(t,e,n){"use strict";var r=t("micro-signals").Signal;e.exports={eventSignals:new r,domSignals:new r}},{"micro-signals":void 0}],"tachikomas/stream":[function(t,e,n){"use strict";var r=t("../../helpers/signals").eventSignals,i=t("./chattersTableVC"),a=t("./twitchEmbededVC"),o=t("./navOptionVC"),s=t("./dateTimeRangeVC"),c=t("../shared/chartFilter"),u=function(t){switch(t.event){case"stream.load":document.getElementById("main").innerHTML=templates["./hbs/stream/index.hbs"](),i.initialize(),o.populateStreamInfo(),o.initialize(),a.initialize(),s.initialize(),r.dispatch({event:"stream.load.ready"});break;case"chatters.data.update.data":i.loadChattersTable();break;case"filter.change":t.changed&&t.changed.filter&&i.loadChattersTable(),t.changed&&t.changed.channel&&o.populateStreamInfo();break;case"filter.interval.change":document.getElementById("interval-selector-btn").innerText=t.label,c.update({intervalLevel:t.intervalLevel});break;case"main.minute":o.populateStreamInfo();break;case"date.change":s.setDate();break;case"main.minute.top":s.minProgressed();break;case"channel.input.update":o.populateStreamInfo();break;case"stream.cleanup":o.destroy(),s.destroy(),i.destroy();break;case"chatters.data.update.partial":i.updateChattersList()}};r.add(u),e.exports=u},{"../../helpers/signals":"tachikomas/signals","../shared/chartFilter":"tachikomas/chartFilter","./chattersTableVC":"tachikomas/chattersTableVC","./dateTimeRangeVC":"tachikomas/dateTimeRangeVC","./navOptionVC":"tachikomas/navOptionVC","./twitchEmbededVC":"tachikomas/twitchEmbededVC"}],"tachikomas/timeseriesVC":[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=u(t);if(e){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=t("../../shared/chartFilter"),moment=t("../../../helpers/moment"),h=t("../../../helpers/constants"),f=t("./ChartRoot"),p=t("../../../simpletons/dataCache"),d=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(d,t);var e,n,r,c,u,f=s(d);function d(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),f.call(this,{chartDomSelector:"canvas-timeseries"})}return e=d,(n=[{key:"_update",value:(c=regeneratorRuntime.mark((function t(){var e,n,r,i,a,o,s,c,u,l,f,d,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getParameters();case 2:for(e=t.sent,n=e.interval,r=e.startBucket,i=e.channel,a=e.filter,o=e.length,s=this._getRootLabels(),c=this._getDataset(),u=0;u<o;u++)for(l=r+u*n,s[u]=moment.unix(l),f=p.get(i,l,l+n,a),d=0;d<h.NUM_TYPES;d++)c[d].data[u]=f[d]._sum,c[d].users[u]=f[d]._users;for(m=0;m<h.NUM_TYPES;m++)c[m].data.length=o,c[m].users.length=o;s.length=o;case 13:case"end":return t.stop()}}),t,this)})),u=function(){var t=this,e=arguments;return new Promise((function(n,r){var a=c.apply(t,e);function o(t){i(a,n,r,o,s,"next",t)}function s(t){i(a,n,r,o,s,"throw",t)}o(void 0)}))},function(){return u.apply(this,arguments)})},{key:"_initializedChartObject",value:function(){this._chartObject&&this._chartObject.destroy(),this._chartObject=new Chart(document.getElementById(this._chartDomSelector),this._defaultChartOptions())}},{key:"_toolTipAfterLabel",value:function(t){if(t){var e=this._getDataset()[t.datasetIndex];if(0!==t.yLabel&&l.getUserFilter().isValid()&&e.users&&e.users[t.dataIndex]){var n=e.users[t.dataIndex];return Object.keys(n).reduce((function(t,e){return t.push("  ".concat(e,": ").concat(n[e])),t}),[])}}}},{key:"_toolTipLabel",value:function(t){return"".concat(t.dataset.label,": ").concat(t.dataset.data[t.dataIndex])}},{key:"_toolTipTitle",value:function(t){var e=(t&&t[0]||{}).dataIndex;if(e>=0)return this._getRootLabels()[e].format("YYYY/MM/DD HH:mm")}},{key:"_toolTipFilter",value:function(t){return t&&"0"!=t.formattedValue}},{key:"_scaleTicksFontStyle",value:function(t){switch(l.getIntervalLevel()){case h.BUCKET_DAY:return 1===t.tick.value.days()?"bold":void 0;case h.BUCKET_HOUR:return 0===t.tick.value.hours()?"bold":void 0;case h.BUCKET_FIVE:return 0===t.tick.value.minutes()?"bold":void 0;case h.BUCKET_MIN:return t.tick.value.minutes()%5==0?"bold":void 0;default:return}}},{key:"_scaleTicksCallback",value:function(t){var e=this._getRootLabels()[t];if(0===e.hours()&&0===e.minutes())return e.format("M/D");switch(l.getIntervalLevel()){case h.BUCKET_DAY:return e.format("M/D");default:return e.format("HH:mm")}}},{key:"_defaultChartOptions",value:function(){for(var t=[],e=0;e<h.NUM_TYPES;e++)t.push({label:h.CHART_LABEL[e],backgroundColor:h.CHART_BACKGROUND_COLOR[e],borderColor:h.CHART_BORDER_COLOR[e],borderWidth:1,data:[],users:[]});return{type:"bar",data:{labels:[],label:"# of Events",datasets:t},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{display:!0,stacked:!0,ticks:{fontColor:"#7d7d7d",fontSize:14,fontStyle:this._scaleTicksFontStyle.bind(this),callback:this._scaleTicksCallback.bind(this)},gridLines:{display:!0,color:"#7d7d7d"}},y:{stacked:!0,gridLines:{display:!0,color:"#7d7d7d"},ticks:{fontColor:"#7d7d7d",fontSize:14,stepSize:5}}},plugins:{title:{display:!1},legend:{labels:{display:!0,color:"#7d7d7d"}},tooltip:{intersect:!1,mode:"index",filter:this._toolTipFilter.bind(this),callbacks:{title:this._toolTipTitle.bind(this),label:this._toolTipLabel.bind(this),afterLabel:this._toolTipAfterLabel.bind(this)}}}}}}}])&&a(e.prototype,n),r&&a(e,r),d}(f));e.exports=d},{"../../../helpers/constants":"tachikomas/constants","../../../helpers/moment":"tachikomas/moment","../../../simpletons/dataCache":"tachikomas/dataCache","../../shared/chartFilter":"tachikomas/chartFilter","./ChartRoot":"tachikomas/ChartRoot"}],"tachikomas/twitchClient":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,c,"next",t)}function c(t){r(o,i,a,s,c,"throw",t)}s(void 0)}))}}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("tmi.js"),_="undefined"!=typeof window?window._:void 0!==n?n._:null,s=t("../models/events"),c=t("../helpers/signals").eventSignals,u=t("../helpers/constants"),l=t("../simpletons/auth"),h=t("../simpletons/api"),f=t("../simpletons/dataCache"),p=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._channel=void 0,this._channelID=void 0,this._enabled=!1,this.updateViewersCache=_.debounce(this._updateViewersCache.bind(this),500,{leading:!1}),this.saveChannel=_.debounce(this._saveChannel.bind(this),500,{leading:!1}),this._debouncedPing=_.debounce(this._ping.bind(this),5e3,{leading:!1}),this._throttledPing=_.throttle(this._ping.bind(this),1e3,{leading:!1}),this._lastPingSuccess=!0,c.add(this._eventSignalFunc.bind(this))}var e,n,r,d,m,y,v,b,g;return e=t,(n=[{key:"_eventSignalFunc",value:function(t){switch(t.event){case"main.minute":t.filter.isValid()||this.updateViewersCache();break;case"stream.cleanup":this._disable();break;case"stream.load.ready":this._enable();break;case"channel.changed":this.changeChannel(t.channel)}}},{key:"initializeClient",value:(g=i(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._client){t.next=2;break}return t.abrupt("return");case 2:if(!p._initPromise){t.next=5;break}return t.next=5,p._initPromise;case 5:return this.getChannel()||(localStorage.getItem("channel")?(this._setChannel(localStorage.getItem("channel")),this._setChannelID(localStorage.getItem("channel-id"))):l.isBroadcaster()?(this._setChannel(l.getLogin()),this._setChannelID(l.getID())):(this._setChannel("xqcow"),this._setChannelID(71092938))),this._client=new o.Client({connection:{secure:!0,reconnect:!0,maxReconnectInterval:1e3,reconnectInterval:1e3,reconnectDecay:1,timeout:5e3},channels:[this.getChannel()]}),this._client.on("chat",(function(t,n,r,i){e._processChatMessage(t,s.Chat,n)})),this._client.on("resub",(function(t,n,r,i,a,o){e._processChatMessage(t,s.ReSub,a,o,r)})),this._client.on("subscription",(function(t,n,r,i,a){e._processChatMessage(t,s.Sub,a,r,0)})),this._client.on("cheer",(function(t,n,r){e._processChatMessage(t,s.Cheer,n)})),this._client.on("ban",(function(t,n,r,i){e._processChatMessage(t,s.Ban,i)})),this._client.on("anongiftpaidupgrade",(function(t,n,r){e._processChatMessage(t,s.AnonGift,r)})),this._client.on("subgift",(function(t,n,r,i,a,o){e._processChatMessage(t,s.SubGift,o,a,r)})),this._client.on("submysterygift",(function(t,n,r,i,a){e._processChatMessage(t,s.MysterySubGift,a,i,r)})),t.next=17,this._client.connect();case 17:this.ping(),this._initPromise=void 0;case 19:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)})},{key:"changeChannel",value:(b=i(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.getChannel()!==e){t.next=2;break}return t.abrupt("return");case 2:return this.getChannel()&&this._client.part(this.getChannel()),this._setChannel(e),this._setChannelID(n),t.next=7,this._client.join(this.getChannel());case 7:this.updateViewersCache(),c.dispatch({event:"channel.input.update",data:{id:this.getChannelID(),channel:this.getChannel()}});case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return b.apply(this,arguments)})},{key:"_processChatMessage",value:function(t,e,n,r,i,a){this.ping();var o=new e(n,r,i,a);f.add("#"===t.charAt(0)?t.substring(1):t,o)}},{key:"_disable",value:function(){this._enabled=!1}},{key:"_enable",value:function(){this._enabled||(this._enabled=!0,this.updateViewersCache())}},{key:"_updateViewersCache",value:(v=i(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._enabled&&this.getChannel()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,h.queryTmiApi("group/user/".concat(this.getChannel(),"/chatters"));case 4:e=t.sent,c.dispatch({event:"chatters.data.update",data:e.chatters,channelID:this.getChannelID()});case 6:case"end":return t.stop()}}),t,this)}))),function(){return v.apply(this,arguments)})},{key:"_setChannel",value:function(t){this._channel=t}},{key:"_setChannelID",value:(y=i(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}this._channelID=e,t.next=9;break;case 4:if(!this.getChannel()){t.next=9;break}return t.next=7,h.queryTwitchApi("kraken/users?login=".concat(this.getChannel()));case 7:n=t.sent,this._channelID=parseInt(n.users[0]._id);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"changeToRandomFeaturedStream",value:(m=i(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.queryTwitchApi("kraken/streams/featured?limit=100");case 3:e=t.sent,n=e.featured.filter((function(t){return t.stream.viewers>100&&t.stream.viewers<=u.MAX_VIEWERS_COUNTS_FOR_PROCESS})),r=n[Math.floor(Math.random()*n.length)],this.changeChannel(r.stream.channel.name,r.stream.channel._id),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),this.changeChannel("xqcow",71092938);case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return m.apply(this,arguments)})},{key:"getChannel",value:function(){return this._channel}},{key:"getChannelID",value:function(){return this._channelID}},{key:"_saveChannel",value:function(){localStorage.setItem("channel",this._channel),localStorage.setItem("channel-id",this._channelID),c.dispatch({alert:{type:"success",body:"Successfully saved channel"}})}},{key:"isConnected",value:function(){return Boolean(this._client._isConnected()&&this._client.channels&&this._client.channels.length>0&&this._lastPingSuccess)}},{key:"_ping",value:(d=i(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._client){t.next=12;break}return t.prev=1,t.next=4,this._client.ping();case 4:this._lastPingSuccess=!0,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),this._lastPingSuccess=!1;case 10:t.next=13;break;case 12:this._lastPingSuccess=!1;case 13:c.dispatch({event:"draw.nav.actvitiy-status"}),this.ping();case 15:case"end":return t.stop()}}),t,this,[[1,7]])}))),function(){return d.apply(this,arguments)})},{key:"ping",value:function(){this.isConnected()?this._debouncedPing():this._throttledPing()}}])&&a(e.prototype,n),r&&a(e,r),t}());p._initPromise=p.initializeClient(),e.exports=p}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../helpers/constants":"tachikomas/constants","../helpers/signals":"tachikomas/signals","../models/events":"tachikomas/events","../simpletons/api":"tachikomas/api","../simpletons/auth":"tachikomas/auth","../simpletons/dataCache":"tachikomas/dataCache","tmi.js":void 0}],"tachikomas/twitchEmbededVC":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("../../singletons/twitchClient"),a=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastSearchedChannel=void 0,this.embededTwitch=void 0,this.twitchEmbededCollapse=void 0,this.streamInfo=void 0,this.toggleEmbededTwitch=_.debounce(this._toggleEmbededTwitch.bind(this),1e3,{leading:!1}),t("../../helpers/signals").domSignals.add(this._domeEventFunction.bind(this))}var n,a,o;return n=e,(a=[{key:"_domeEventFunction",value:function(t){"click"===t.type&&"embeded-twitch-collapse"===t.id&&this.toggleEmbededTwitch()}},{key:"_getIsOpenTwitchEmbeded",value:function(){var t=localStorage.getItem("isOpenTwitchEmbeded");return!t||JSON.parse(t)}},{key:"_handleEmbededTwitch",value:function(){this._getIsOpenTwitchEmbeded()?this.embededTwitch=new Twitch.Embed("twitch-embed",{width:"100%",height:"100%",channel:i.getChannel(),autoplay:!0,muted:!0,allowfullscreen:!1}):this.embededTwitch&&this.embededTwitch.destroy()}},{key:"_toggleEmbededTwitch",value:function(){var t=document.getElementById("twitch-embed").classList.contains("show");localStorage.setItem("isOpenTwitchEmbeded",JSON.stringify(Boolean(t))),this._handleEmbededTwitch()}},{key:"initialize",value:function(){this.destroy();var t=document.getElementById("embeded-twitch-collapse");this.twitchEmbededCollapse=new BSN.Collapse(t),this._getIsOpenTwitchEmbeded()?this._handleEmbededTwitch():this.twitchEmbededCollapse.hide()}},{key:"destroy",value:function(){this.twitchEmbededCollapse&&(this.twitchEmbededCollapse.dispose(),this.twitchEmbededCollapse=void 0),this.embededTwitch&&(this.embededTwitch.destroy(),this.embededTwitch=void 0)}}])&&r(n.prototype,a),o&&r(n,o),e}();e.exports=new a},{"../../helpers/signals":"tachikomas/signals","../../singletons/twitchClient":"tachikomas/twitchClient"}],"tachikomas/userFilter":[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=t("../../../singletons/users"),a=t("../../../singletons/twitchClient"),o=new(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.changeSearchString(e)}var e,n,o;return e=t,(n=[{key:"changeSearchString",value:function(t){this._searchString=this._getCleanedSearchString(t),":following"===this._searchString?this.isApplicable=this._isFollowing:":notfollowing"===this._searchString?this.isApplicable=this._isNotFollowing:0!==this._searchString.indexOf(":")&&this.isValid()?this.isApplicable=this._isStringIncluded:this.isApplicable=function(){return!0}}},{key:"_isFollowing",value:function(t){var e=i.getUserByName(t);if(e)return e.isFollowing(a.getChannelID())}},{key:"_isNotFollowing",value:function(t){var e=this._isFollowing(t);if(void 0!==e)return!e}},{key:"_isStringIncluded",value:function(t){return t.toLowerCase().indexOf(this._searchString)>-1}},{key:"_getCleanedSearchString",value:function(t){return(t||"").trim().toLowerCase()}},{key:"filterUsers",value:function(t){var e=this;return this.isValid()?t.filter((function(t){return e.isApplicable(t._userName)})):t}},{key:"isSameSearchString",value:function(t){return this._getCleanedSearchString(t)===this._searchString}},{key:"isValid",value:function(){return Boolean(this._searchString)}}])&&r(e.prototype,n),o&&r(e,o),t}());e.exports=o},{"../../../singletons/twitchClient":"tachikomas/twitchClient","../../../singletons/users":"tachikomas/users"}],"tachikomas/userFollowsFetcher":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _="undefined"!=typeof window?window._:void 0!==n?n._:null,a=t("../../simpletons/auth"),o=t("../../simpletons/api"),s=t("../../helpers/signals").eventSignals,c=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset(),this._paginations={},this.fetch=_.throttle(this._fetch,5e3)}var e,n,c,u,l;return e=t,(n=[{key:"reset",value:function(){this._toFetch=new Set,this._running=0,this._toFetchArray&&(this._toFetchArray.length=0),this._toFetchArray=void 0}},{key:"add",value:function(t){this._toFetch.add(t),this.fetch()}},{key:"_fetch",value:function(){if(this._toFetchArray=Array.from(this._toFetch),0!==this._toFetchArray.length)for(var t=this._running;t<5;t++)this._running++,this._fetchUserFollows()}},{key:"_fetchUserFollows",value:(u=regeneratorRuntime.mark((function t(){var e,n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.getAuthObj();case 2:e=t.sent;case 3:if((n=(this._toFetchArray||[]).shift())&&"done"!==this._paginations[n]){t.next=7;break}return this._toFetch.delete(n),t.abrupt("break",28);case 7:t.prev=7;case 8:return r="helix/users/follows?first=100&from_id=".concat(n),t.next=11,o.queryTwitchApi(this._paginations[n]?"".concat(r,"&after=").concat(this._paginations[n]):r,e);case 11:if(i=t.sent,s.dispatch({event:"fetch.user.follows.resp",data:i,userID:n}),i.pagination&&i.pagination.cursor){t.next=17;break}return this._paginations[n]="done",this._toFetch.delete(n),t.abrupt("break",20);case 17:this._paginations[n]=i.pagination.cursor;case 18:t.next=8;break;case 20:t.next=26;break;case 22:return t.prev=22,t.t0=t.catch(7),console.warn("failed to fetch user follows",t.t0),t.abrupt("break",28);case 26:t.next=3;break;case 28:this._running=Math.max(0,this._running-1);case 29:case"end":return t.stop()}}),t,this,[[7,22]])})),l=function(){var t=this,e=arguments;return new Promise((function(n,i){var a=u.apply(t,e);function o(t){r(a,n,i,o,s,"next",t)}function s(t){r(a,n,i,o,s,"throw",t)}o(void 0)}))},function(){return l.apply(this,arguments)})}])&&i(e.prototype,n),c&&i(e,c),t}());e.exports=c}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../helpers/signals":"tachikomas/signals","../../simpletons/api":"tachikomas/api","../../simpletons/auth":"tachikomas/auth"}],"tachikomas/userIDFetcher":[function(t,e,n){(function(n){(function(){"use strict";function r(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){a(o,r,i,s,c,"next",t)}function c(t){a(o,r,i,s,c,"throw",t)}s(void 0)}))}}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _="undefined"!=typeof window?window._:void 0!==n?n._:null,c=t("../../simpletons/auth"),u=t("../../simpletons/api"),l=t("../../helpers/signals").eventSignals,h=!1,f=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}var e,n,i,a,f;return e=t,(n=[{key:"reset",value:function(){this._names=new Set,this.fetch=_.throttle(this._fetch,2e3)}},{key:"add",value:function(t){this._names.add(t),this.fetch()}},{key:"_fetch",value:(f=o(regeneratorRuntime.mark((function t(){var e,n,r,i,a,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!h){t.next=2;break}return t.abrupt("return");case 2:return h=!0,e=Array.from(this._names),t.next=6,c.getAuthObj();case 6:for(n=t.sent,r=[],i=0;i<e.length;i+=100)r.push(e.slice(i,i+100));t.prev=9,a=0,o=r;case 11:if(!(a<o.length)){t.next=18;break}return s=o[a],t.next=15,this._fetchUserIDsForNames(n,s);case 15:a++,t.next=11;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(9),console.warn("failed to query for ids",t.t0);case 23:h=!1;case 24:case"end":return t.stop()}}),t,this,[[9,20]])}))),function(){return f.apply(this,arguments)})},{key:"_fetchUserIDsForNames",value:(a=o(regeneratorRuntime.mark((function t(e,n){var i,a,o,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="helix/users?login=".concat(n.join("&login=")),t.next=3,u.queryTwitchApi(i,e);case 3:a=t.sent,o=r(a.data);try{for(o.s();!(s=o.n()).done;)c=s.value,this._names.delete(c.login.toLowerCase())}catch(t){o.e(t)}finally{o.f()}l.dispatch({event:"fetch.user.ids.resp",data:a});case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})}])&&s(e.prototype,n),i&&s(e,i),t}());e.exports=f}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../helpers/signals":"tachikomas/signals","../../simpletons/api":"tachikomas/api","../../simpletons/auth":"tachikomas/auth"}],"tachikomas/users":[function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=t("../../helpers/signals").eventSignals,u=t("./User"),l=t("./userIDFetcher"),h=t("./userFollowsFetcher"),f=t("../../helpers/constants"),p=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset(),c.add(this._eventSignalFunc.bind(this))}var e,n,o;return e=t,(n=[{key:"_eventSignalFunc",value:function(t){switch(t.event){case"chatters.data.update":this.processChattersData(t.data,t.channelID),c.dispatch({event:"chatters.data.update.data"});break;case"fetch.user.ids.resp":this.processUserIDsResp(t.data);break;case"fetch.user.follows.resp":this.processUserFollowsResp(t.data);break;case"api.unthrottled":l.fetch(),h.fetch();break;case"channel.input.update":l.reset(),h.reset();break;case"fetch.channel.follows.resp":this.processUserFollowsResp(t.data)}}},{key:"reset",value:function(){this._viewers={},this._idToUser={},this._nameToUser={},this._channelWarned={}}},{key:"getUserByID",value:function(t){return this._idToUser[t]}},{key:"getUserByName",value:function(t){return this._nameToUser[t]}},{key:"getViewers",value:function(){return this._viewers}},{key:"getUsers",value:function(t){var e=Object.values(this._idToUser);return t&&t.isValid()?t.filterUsers(e):e}},{key:"_ensureUserExists",value:function(t,e){var n=e.toLowerCase(),r=this.getUserByID(t)||this.getUserByName(n)||new u(t,e);return r._id=r._id||t,t&&(this._idToUser[t]=r),this._nameToUser[n]=r,r}},{key:"processChattersData",value:function(t,e){for(var n=this,r={},a=Object.values(t||{}).reduce((function(t,e){return e.length+t}),0),o=0,s=Object.entries(t||{});o<s.length;o++){var u=i(s[o],2),h=u[0],p=u[1];r[h]=p.sort().map((function(t){var e=t.toLowerCase();return n.getUserByName(e)||a<f.MAX_VIEWERS_COUNTS_FOR_PROCESS&&l.add(t),n._ensureUserExists(void 0,t)}))}a>=f.MAX_VIEWERS_COUNTS_FOR_PROCESS&&!this._channelWarned[e]&&(this._channelWarned[e]=!0,c.dispatch({alert:{type:"warning",body:"This channel has higher than ".concat(f.MAX_VIEWERS_COUNTS_FOR_PROCESS," viewers.  Halting some data gatherings to conserve API requests.")}})),this._viewers=r}},{key:"processUserFollowsResp",value:function(t){var e=this;t.data.forEach((function(t){var n=parseInt(t.to_id),r=parseInt(t.from_id),i=e._ensureUserExists(n,t.to_name),a=e._ensureUserExists(r,t.from_name);a.addFollowing(i.getID()),i.addFollowedBy(a.getID())})),c.dispatch({event:"chatters.data.update.partial"})}},{key:"processUserIDsResp",value:function(t){var e,n=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}(t.data);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this._ensureUserExists(r.id,r.login);h.add(i.getID())}}catch(t){n.e(t)}finally{n.f()}}},{key:"getTopFollowedBySummary",value:function(t,e){var n=this;return e.filterUsers(Object.values(this._idToUser)).sort((function(t,e){var n=(e.getFollowedByCounts()||0)-(t.getFollowedByCounts()||0);return 0===n?e.getID()-t.getID():n})).slice(0,10).map((function(e){return n._getFollowedBySummary(t,e.getID())}))}},{key:"_getFollowedBySummary",value:function(t,e){var n=this;if(this.getUserByID(e))return r(this.getUserByID(e)._followedBy||[]).map((function(t){return n.getUserByID(t)})).reduce((function(e,n){switch(n.isFollowing(t)){case void 0:e.unknown++;break;case!0:e.following++;break;case!1:e.admiring++}return e}),{userID:e,unknown:0,following:0,admiring:0})}}])&&s(e.prototype,n),o&&s(e,o),t}());e.exports=p},{"../../helpers/constants":"tachikomas/constants","../../helpers/signals":"tachikomas/signals","./User":"tachikomas/User","./userFollowsFetcher":"tachikomas/userFollowsFetcher","./userIDFetcher":"tachikomas/userIDFetcher"}],"tachikomas/utils":[function(t,e,n){"use strict";var moment=t("../helpers/moment"),r=t("./constants"),i=t("../models/events"),a=t("material-color-hash").default,o=function(t,e){return"".concat(a(t,"200").backgroundColor).concat(e)};e.exports={muteSeconds:function(t){return t.set({second:0,millisecond:0})},getTimeBucket:function(t,e){if(e==r.BUCKET_DAY){var n=moment.unix(t);return n.set({hour:0,minute:0,second:0,millisecond:0}),n.unix()}return t-t%e},extractTabObj:function(t){if(0===t.length)return{tab:r.TABS_OPTIONS[0],args:{}};var e=t.indexOf("?")>-1?t.indexOf("?"):t.length,n=t.substr(1,e-1).toLowerCase(),i=r.TABS_OPTIONS.indexOf(n)>-1?n:r.TABS_OPTIONS[0],a=new URLSearchParams(t.substr(n.length+1));return{tab:i,args:Object.fromEntries(a.entries())}},getNow:function(){return moment().set({second:0,millisecond:0})},getMessageType:function(t){switch(!0){case t instanceof i.AnonGift:return r.TYPE_ANONGIFT;case t instanceof i.Ban:return r.TYPE_BAN;case t instanceof i.Cheer:return r.TYPE_CHEER;case t instanceof i.Chat:return r.TYPE_CHAT;case t instanceof i.MysterySubGift:return r.TYPE_SUBMYSTERY;case t instanceof i.ReSub:return r.TYPE_RESUB;case t instanceof i.SubGift:return r.TYPE_SUBGIFT;case t instanceof i.Sub:return r.TYPE_SUB;default:throw"invalid object type: ".concat(t)}},getRaw:function(t,e){switch(parseInt(t)){case r.TYPE_ANONGIFT:return new i.AnonGift(e);case r.TYPE_BAN:return new i.Ban(e);case r.TYPE_CHEER:return new i.Cheer(e);case r.TYPE_CHAT:return new i.Chat(e);case r.TYPE_SUBMYSTERY:return new i.MysterySubGift(e);case r.TYPE_RESUB:return new i.ReSub(e);case r.TYPE_SUBGIFT:return new i.SubGift(e);case r.TYPE_SUB:return new i.Sub(e);default:throw"invalid message type: ".concat(t)}},getHashedColor:function(t,e){return o(t,e)},getBackgroundColor:function(t){return t.map((function(t){return o(t,"4D")}))},getBorderColor:function(t){return t.map((function(t){return o(t,"FF")}))}}},{"../helpers/moment":"tachikomas/moment","../models/events":"tachikomas/events","./constants":"tachikomas/constants","material-color-hash":void 0}]},{},["tachikomas/env","tachikomas/chartFilter","tachikomas/userFilter","tachikomas/ChartRoot","tachikomas/chatsByUsersVC","tachikomas/followedStreamersVC","tachikomas/proceedsByTypesVC","tachikomas/proceedsByUsersVC","tachikomas/timeseriesVC","tachikomas/chattersTableVC","tachikomas/Chatters","tachikomas/DateTime","tachikomas/dateTimeRangeVC","tachikomas/stream","tachikomas/navOptionVC","tachikomas/twitchEmbededVC","tachikomas/constants","tachikomas/moment","tachikomas/signals","tachikomas/utils","tachikomas/main","tachikomas/AnonGift","tachikomas/Ban","tachikomas/Chat","tachikomas/Cheer","tachikomas/Common","tachikomas/events","tachikomas/MysterySubGift","tachikomas/ReSub","tachikomas/Sub","tachikomas/SubGift","tachikomas/api","tachikomas/auth","tachikomas/dataCache","tachikomas/blanks","tachikomas/DataBucket","tachikomas/DataChannel","tachikomas/DataNode","tachikomas/twitchClient","tachikomas/channelFollowsFetcher","tachikomas/users","tachikomas/User","tachikomas/userFollowsFetcher","tachikomas/userIDFetcher"]);